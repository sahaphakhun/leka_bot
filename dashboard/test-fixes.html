<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .test-button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .test-button:hover { background: #0056b3; }
        .result { margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 4px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
    </style>
</head>
<body>
    <h1>üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Dashboard</h1>
    
    <div class="test-section">
        <h2>1. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</h2>
        <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå</p>
        <button class="test-button" onclick="testFileInfoAPI()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö API ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå</button>
        <div id="fileInfoResult" class="result"></div>
    </div>

    <div class="test-section">
        <h2>2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</h2>
        <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</p>
        <button class="test-button" onclick="testSubmitTaskAPI()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö API ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</button>
        <div id="submitTaskResult" class="result"></div>
    </div>

    <div class="test-section">
        <h2>3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</h2>
        <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</p>
        <button class="test-button" onclick="testDownloadFileAPI()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö API ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</button>
        <div id="downloadFileResult" class="result"></div>
    </div>

    <div class="test-section">
        <h2>4. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h2>
        <div>
            <label>Group ID:</label>
            <input type="text" id="groupId" value="test-group" style="margin: 0 10px;">
        </div>
        <div>
            <label>File ID:</label>
            <input type="text" id="fileId" value="test-file" style="margin: 0 10px;">
        </div>
        <div>
            <label>Task ID:</label>
            <input type="text" id="taskId" value="test-task" style="margin: 0 10px;">
        </div>
    </div>

    <script>
        const API_BASE = window.location.origin;

        function showResult(elementId, message, isSuccess = true) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `result ${isSuccess ? 'success' : 'error'}`;
        }

        async function testFileInfoAPI() {
            const groupId = document.getElementById('groupId').value;
            const fileId = document.getElementById('fileId').value;
            
            try {
                const response = await fetch(`${API_BASE}/api/groups/${groupId}/files/${fileId}`);
                const data = await response.json();
                
                if (response.ok) {
                    showResult('fileInfoResult', `‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${JSON.stringify(data, null, 2)}`);
                } else {
                    showResult('fileInfoResult', `‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${data.error || 'Unknown error'}`, false);
                }
            } catch (error) {
                showResult('fileInfoResult', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, false);
            }
        }

        async function testSubmitTaskAPI() {
            const groupId = document.getElementById('groupId').value;
            const taskId = document.getElementById('taskId').value;
            
            try {
                const formData = new FormData();
                formData.append('userId', 'test-user');
                formData.append('comment', '‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô');
                
                const response = await fetch(`${API_BASE}/api/groups/${groupId}/tasks/${taskId}/submit`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showResult('submitTaskResult', `‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${JSON.stringify(data, null, 2)}`);
                } else {
                    showResult('submitTaskResult', `‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${data.error || 'Unknown error'}`, false);
                }
            } catch (error) {
                showResult('submitTaskResult', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, false);
            }
        }

        async function testDownloadFileAPI() {
            const groupId = document.getElementById('groupId').value;
            const fileId = document.getElementById('fileId').value;
            
            try {
                const response = await fetch(`${API_BASE}/api/groups/${groupId}/files/${fileId}/download`);
                
                if (response.ok) {
                    showResult('downloadFileResult', `‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ (Content-Type: ${response.headers.get('Content-Type')})`);
                } else {
                    const data = await response.json().catch(() => ({}));
                    showResult('downloadFileResult', `‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${data.error || 'Unknown error'}`, false);
                }
            } catch (error) {
                showResult('downloadFileResult', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, false);
            }
        }

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API endpoints ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
        window.addEventListener('load', async () => {
            try {
                const response = await fetch(`${API_BASE}/api/groups/test-group/files`);
                if (response.ok) {
                    console.log('‚úÖ API endpoints ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ');
                }
            } catch (error) {
                console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API ‡πÑ‡∏î‡πâ:', error.message);
            }
        });
    </script>
</body>
</html>
