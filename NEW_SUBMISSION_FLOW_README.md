# Flow р╣Гр╕лр╕бр╣Ир╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ

## ЁЯОп **Flow р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г:**

1. **р╕Юр╕┤р╕бр╕Юр╣М "р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ"** тЖТ р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╣Гр╕лр╕Нр╣Ир╣Бр╕кр╕Фр╕Зр╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Чр╕╡р╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Ар╕кр╕гр╣Зр╕И
2. **р╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╕В 1-10** тЖТ р╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щр╕Хр╕▓р╕бр╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕З
3. **р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╕вр╕╖р╕Щр╕вр╕▒р╕Щ** тЖТ р╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М
4. **р╕Цр╣Йр╕▓р╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М** тЖТ р╕кр╣Ир╕Зр╣Др╕Яр╕ер╣Мр╕Бр╣Ир╕нр╕Щ р╣Бр╕ер╣Йр╕зр╕Др╣Ир╕нр╕вр╕Бр╕Фр╕Ыр╕╕р╣Ир╕бр╕вр╕╖р╕Щр╕вр╕▒р╕Щ

## ЁЯФз **р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Чр╕╡р╣Ир╕Чр╕│:**

### 1. р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Гр╕Щ `handleTextMessage`

#### **р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б "р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ"**
```typescript
if (trimmedText === 'р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ') {
  // р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╣Гр╕лр╕Нр╣Ир╣Бр╕кр╕Фр╕Зр╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
  const allTasksCard = FlexMessageTemplateService.createAllPersonalTasksCard(tasks, [], user);
  await this.lineService.replyMessage(replyToken!, allTasksCard);
  
  // р╣Бр╕кр╕Фр╕Зр╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│
  await this.lineService.replyMessage(replyToken!, 
    'ЁЯТб **р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ:**\n\n' +
    `ЁЯУЭ р╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╣Вр╕Фр╕вр╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╕В 1-${tasks.length} р╣Гр╕Щр╣Бр╕Кр╕Ч\n\n` +
    'ЁЯУО **р╕Цр╣Йр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М:**\n' +
    '1. р╕кр╣Ир╕Зр╣Др╕Яр╕ер╣Мр╣Гр╕Щр╣Бр╕Кр╕Чр╕Бр╣Ир╕нр╕Щ\n' +
    '2. р╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕кр╣Ир╕З\n' +
    '3. р╣Ар╕ер╕╖р╕нр╕Б "р╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М" р╣Гр╕Щр╕Бр╕▓р╕гр╣Мр╕Фр╕вр╕╖р╕Щр╕вр╕▒р╕Щ\n\n' +
    'ЁЯУд **р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М:**\n' +
    '1. р╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕кр╣Ир╕З\n' +
    '2. р╣Ар╕ер╕╖р╕нр╕Б "р╣Др╕бр╣Ир╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М" р╣Гр╕Щр╕Бр╕▓р╕гр╣Мр╕Фр╕вр╕╖р╕Щр╕вр╕▒р╕Щ'
  );
}
```

#### **р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Хр╕▒р╕зр╣Ар╕ер╕В**
```typescript
else if (/^\d+$/.test(trimmedText)) {
  // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
  const taskIndex = parseInt(trimmedText) - 1;
  
  if (taskIndex >= 0 && taskIndex < tasks.length) {
    const selectedTask = tasks[taskIndex];
    // р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ
    const confirmationCard = FlexMessageTemplateService.createTaskSubmissionConfirmationCard(selectedTask, files, user);
    await this.lineService.replyMessage(replyToken!, confirmationCard);
  } else {
    // р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф
    await this.lineService.replyMessage(replyToken!, 
      `тЭМ р╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╕гр╕░р╕Ър╕╕р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З\n\n` +
      `ЁЯУЭ р╕Бр╕гр╕╕р╕Ур╕▓р╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╕В 1-${tasks.length} р╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ\n\n` +
      `ЁЯТб р╕Юр╕┤р╕бр╕Юр╣М "р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ" р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Зр╕▓р╕Щр╣Гр╕лр╕бр╣И`
    );
  }
}
```

### 2. р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╣Мр╕Фр╣Гр╕лр╕бр╣Ир╣Гр╕Щ `FlexMessageTemplateService`

#### **`createTaskSubmissionConfirmationCard`**
- р╣Бр╕кр╕Фр╕Зр╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╣Ар╕ер╕╖р╕нр╕Б
- р╣Бр╕кр╕Фр╕Зр╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Бр╕ер╣Йр╕з (р╕Цр╣Йр╕▓р╕бр╕╡)
- р╕бр╕╡р╕Ыр╕╕р╣Ир╕бр╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М
- р╕бр╕╡р╕Ыр╕╕р╣Ир╕бр╕вр╕Бр╣Ар╕ер╕┤р╕Б

### 3. р╣Ар╕Юр╕┤р╣Ир╕б Postback Event р╣Гр╕лр╕бр╣И

#### **`confirm_task_submission`**
```typescript
case 'confirm_task_submission': {
  const taskId = params.get('taskId');
  const hasFiles = params.get('hasFiles') === 'true';
  
  if (hasFiles) {
    // р╕Цр╣Йр╕▓р╕бр╕╡р╣Др╕Яр╕ер╣М р╣Гр╕лр╣Йр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣Мр╕Бр╣Ир╕нр╕Щ
    const fileIds = files.map((f: any) => f.id);
    const task = await this.taskService.recordSubmission(taskId, userId, fileIds, 'р╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╕Юр╕гр╣Йр╕нр╕бр╣Др╕Яр╕ер╣Мр╕Ир╕▓р╕Бр╣Бр╕Кр╕Чр╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕з');
    await this.lineService.replyMessage(replyToken, 
      `тЬЕ р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ "${task.title}" р╕Юр╕гр╣Йр╕нр╕бр╣Др╕Яр╕ер╣Мр╣Бр╕Щр╕Ъ ${fileIds.length} р╣Др╕Яр╕ер╣М р╕кр╕│р╣Ар╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕зр╕Др╣Ир╕░`
    );
  } else {
    // р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡р╣Др╕Яр╕ер╣М р╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╣Ар╕ер╕в
    const task = await this.taskService.recordSubmission(taskId, userId, [], 'р╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕бр╕╡р╣Др╕Яр╕ер╣Мр╣Бр╕Щр╕Ъ');
    await this.lineService.replyMessage(replyToken, 
      `тЬЕ р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ "${task.title}" р╕кр╕│р╣Ар╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕зр╕Др╣Ир╕░ (р╣Др╕бр╣Ир╕бр╕╡р╣Др╕Яр╕ер╣Мр╣Бр╕Щр╕Ъ)`
    );
  }
}
```

## ЁЯУ▒ **р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Гр╕лр╕бр╣И:**

### **р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 1: р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ**
1. р╕Юр╕┤р╕бр╕Юр╣М **"р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ"** р╣Гр╕Щр╣Бр╕Кр╕Чр╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕з
2. р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╣Гр╕лр╕Нр╣Ир╣Бр╕кр╕Фр╕Зр╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Чр╕╡р╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Ар╕кр╕гр╣Зр╕И
3. р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### **р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 2: р╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щ**
1. р╕Юр╕┤р╕бр╕Юр╣М **р╣Ар╕ер╕В 1-10** р╣Гр╕Щр╣Бр╕Кр╕Ч (р╕Хр╕▓р╕бр╕Ир╕│р╕Щр╕зр╕Щр╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╕бр╕╡)
2. р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ
3. р╕Бр╕▓р╕гр╣Мр╕Фр╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Зр╕▓р╕Щр╣Бр╕ер╕░р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Бр╕ер╣Йр╕з

### **р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 3: р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ**
1. **р╕Цр╣Йр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М:**
   - р╕кр╣Ир╕Зр╣Др╕Яр╕ер╣Мр╣Гр╕Щр╣Бр╕Кр╕Чр╕Бр╣Ир╕нр╕Щ
   - р╕Бр╕Фр╕Ыр╕╕р╣Ир╕б "ЁЯУО р╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╕Юр╕гр╣Йр╕нр╕бр╣Др╕Яр╕ер╣М"
   
2. **р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М:**
   - р╕Бр╕Фр╕Ыр╕╕р╣Ир╕б "ЁЯУд р╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕бр╕╡р╣Др╕Яр╕ер╣М"

### **р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 4: р╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╕кр╕│р╣Ар╕гр╣Зр╕И**
- р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ
- р╕Зр╕▓р╕Щр╕Ир╕░р╕Цр╕╣р╕Бр╕кр╣Ир╕Зр╣Др╕Ыр╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╕Хр╕гр╕зр╕Ир╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ

## ЁЯОи **р╕Бр╕▓р╕гр╣Мр╕Фр╣Гр╕лр╕бр╣Ир╕Чр╕╡р╣Ир╣Ар╕Юр╕┤р╣Ир╕б:**

### **1. р╕Бр╕▓р╕гр╣Мр╕Фр╣Бр╕кр╕Фр╕Зр╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф**
- р╣Бр╕кр╕Фр╕Зр╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕кр╣Ир╕З
- р╕бр╕╡р╕Ыр╕╕р╣Ир╕бр╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щр╣Бр╕Хр╣Ир╕ер╕░р╕Зр╕▓р╕Щ
- р╣Бр╕кр╕Фр╕Зр╕Ир╕│р╕Щр╕зр╕Щр╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Бр╕ер╣Йр╕з

### **2. р╕Бр╕▓р╕гр╣Мр╕Фр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ**
- р╣Бр╕кр╕Фр╕Зр╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╣Ар╕ер╕╖р╕нр╕Б
- р╣Бр╕кр╕Фр╕Зр╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Бр╕ер╣Йр╕з
- р╕бр╕╡р╕Ыр╕╕р╣Ир╕бр╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М
- р╕бр╕╡р╕Ыр╕╕р╣Ир╕бр╕вр╕Бр╣Ар╕ер╕┤р╕Б

## ЁЯФД **Flow р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ:**

```
р╕Юр╕┤р╕бр╕Юр╣М "р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ" 
    тЖУ
р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф + р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│
    тЖУ
р╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╕В 1-10
    тЖУ
р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ
    тЖУ
р╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М
    тЖУ
р╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╕кр╕│р╣Ар╕гр╣Зр╕И
```

## тЬЕ **р╕Вр╣Йр╕нр╕Фр╕╡р╕Вр╕нр╕З Flow р╣Гр╕лр╕бр╣И:**

1. **р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Зр╣Ир╕▓р╕в**: р╕Юр╕┤р╕бр╕Юр╣Мр╣Бр╕Др╣И "р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ" р╣Бр╕ер╣Йр╕зр╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щр╕Хр╕▓р╕бр╣Ар╕ер╕В
2. **р╣Ар╕лр╣Зр╕Щр╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф**: р╣Бр╕кр╕Фр╕Зр╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕кр╣Ир╕Зр╣Гр╕Щр╕Др╕гр╕▒р╣Йр╕Зр╣Ар╕Фр╕╡р╕вр╕з
3. **р╣Ар╕ер╕╖р╕нр╕Бр╣Др╕Фр╣Й**: р╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣Мр╣Др╕Фр╣Й
4. **р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ**: р╣Бр╕Хр╣Ир╕ер╕░р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕бр╕╡р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕Чр╕╡р╣Ир╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ
5. **р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕лр╕ер╕▓р╕вр╕Зр╕▓р╕Щ**: р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Зр╕▓р╕Щр╕бр╕▓р╕Бр╕Бр╕зр╣Ир╕▓ 5 р╕гр╕▓р╕вр╕Бр╕▓р╕г

## ЁЯУЭ **р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Др╕Фр╣Й:**

- **"р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ"** - р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕кр╣Ир╕Зр╕Зр╕▓р╕Щ
- **"р╕Зр╕▓р╕Щ"** - р╕Фр╕╣р╕Зр╕▓р╕Щр╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕з (р╣Бр╕Ър╕Ър╣Ар╕Фр╕┤р╕б)
- **р╣Ар╕ер╕В 1-10** - р╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щр╕Хр╕▓р╕бр╣Ар╕ер╕В
- **р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕нр╕╖р╣Ир╕Щр╣Ж** - р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Бр╕Ър╕Ър╣Ар╕Фр╕┤р╕б

## ЁЯзк **р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ:**

1. р╕Юр╕┤р╕бр╕Юр╣М "р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ" р╣Гр╕Щр╣Бр╕Кр╕Чр╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕з
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕гр╕░р╕Ър╕Ър╣Бр╕кр╕Фр╕Зр╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
3. р╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╕В 1 р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щр╣Бр╕гр╕Б
4. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕гр╕░р╕Ър╕Ър╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╕вр╕╖р╕Щр╕вр╕▒р╕Щ
5. р╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М
6. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Зр╕▓р╕Щр╕Цр╕╣р╕Бр╕кр╣Ир╕Зр╕кр╕│р╣Ар╕гр╣Зр╕И

## ЁЯУБ **р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╣Бр╕Бр╣Йр╣Др╕В:**

- `src/controllers/webhookController.ts` - р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕ер╕░ postback events
- `src/services/FlexMessageTemplateService.ts` - р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╣Мр╕Фр╣Гр╕лр╕бр╣И

## ЁЯОЙ **р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М:**

р╕гр╕░р╕Ър╕Ър╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╕бр╕╡ flow р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Зр╣Ир╕▓р╕вр╣Бр╕ер╕░р╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕Зр╣Ир╕▓р╕вр╕Вр╕╢р╣Йр╕Щ р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╣Вр╕Фр╕вр╕Бр╕▓р╕гр╕Юр╕┤р╕бр╕Юр╣М "р╕кр╣Ир╕Зр╕Зр╕▓р╕Щ" р╣Бр╕ер╣Йр╕зр╣Ар╕ер╕╖р╕нр╕Бр╕Зр╕▓р╕Щр╕Хр╕▓р╕бр╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕З р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ър╣Ар╕ер╕╖р╕нр╕Бр╣Др╕Фр╣Йр╕зр╣Ир╕▓р╕Ир╕░р╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╣Бр╕Щр╕Ър╣Др╕Яр╕ер╣М
