import{c as Y,r as h,u as X,j as e,C as Z,a as V,b as k,T as ee,d as se}from"./index-CkUAMYdr.js";import{I as te}from"./input-DKGNKTR-.js";import{S as T,a as C,b as S,c as M,d as o}from"./select-DPXkz_pv.js";import{C as re,a as ne}from"./chevron-right-_VcdZaD6.js";import{F as ae}from"./filter-DEc-M-i3.js";import{S as le}from"./search-cCVafR11.js";import"./index-BuCVsLOD.js";import"./chevron-down-CyNZVHST.js";import"./check-Eaa5JV2K.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=Y("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=Y("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),oe=["อา","จ","อ","พ","พฤ","ศ","ส"],F=new Set(["completed","approved","submitted","reviewed","auto_approved","done"]),ce=new Set(["in_progress","in-progress","processing","review"]),xe=new Set(["pending","waiting","scheduled","new"]),p=x=>{const f=new Date(x);return f.setHours(0,0,0,0),f},g=x=>x.dueDate?new Date(x.dueDate):x.dueTime?new Date(x.dueTime):x.scheduledDate?new Date(x.scheduledDate):x.startTime?new Date(x.startTime):null,R={new:"งานใหม่",pending:"รอดำเนินการ",scheduled:"รอกำหนดส่ง","in-progress":"กำลังดำเนินการ",in_progress:"กำลังดำเนินการ",completed:"เสร็จแล้ว",approved:"อนุมัติแล้ว",submitted:"ส่งแล้ว",reviewed:"ตรวจแล้ว",overdue:"เกินกำหนด",cancelled:"ยกเลิก"},Ne=({tasks:x=[]})=>{const[f,N]=h.useState(new Date),[j,L]=h.useState(p(new Date)),[d,y]=h.useState({search:"",status:"all",priority:"all",assignee:"all",due:"all"}),{openTaskDetail:v,openAddTask:U}=X(),u=h.useMemo(()=>p(new Date),[]),w=h.useMemo(()=>{const s=new Date;return s.setHours(23,59,59,999),s},[]),E=h.useMemo(()=>{const s=new Date;return s.setDate(s.getDate()+7),s.setHours(23,59,59,999),s},[]),I=h.useMemo(()=>{const s=f.getFullYear(),t=f.getMonth(),n=new Date(s,t,1),c=new Date(s,t+1,0),i=n.getDay(),r=[];for(let l=i-1;l>=0;l--)r.push({date:new Date(s,t,-l),isCurrentMonth:!1});for(let l=1;l<=c.getDate();l++)r.push({date:new Date(s,t,l),isCurrentMonth:!0});for(;r.length%7!==0;){const l=r[r.length-1].date;r.push({date:new Date(l.getFullYear(),l.getMonth(),l.getDate()+1),isCurrentMonth:!1})}const a=[];for(let l=0;l<r.length;l+=7)a.push(r.slice(l,l+7));return a},[f]),b=s=>F.has((s.status||"").toLowerCase()),m=h.useMemo(()=>x.filter(s=>{const t=(s.title||"").toLowerCase(),n=(s.description||"").toLowerCase(),c=d.search.toLowerCase();if(!(!d.search||t.includes(c)||n.includes(c)))return!1;if(d.status!=="all"){const r=(s.status||"").toLowerCase();if(d.status==="overdue"){const a=g(s);if(!(r==="overdue")&&(!a||a>=u||b(s)))return!1}else if(d.status==="in_progress"){if(!ce.has(r))return!1}else if(d.status==="pending"){if(!xe.has(r))return!1}else if(d.status==="completed"&&!F.has(r))return!1}if(d.priority!=="all"&&(s.priority||"").toLowerCase()!==d.priority)return!1;if(d.assignee!=="all"){const r=new Set;if(Array.isArray(s.assignedUsers)&&s.assignedUsers.forEach(a=>r.add(a.displayName||a.name||a.lineUserId)),s.assignee&&r.add(s.assignee.name||s.assignee.displayName||s.assignee.lineUserId),!r.has(d.assignee))return!1}if(d.due!=="all"){const r=g(s);if(r){if(d.due==="today"){if(!(r>=u&&r<=w))return!1}else if(d.due==="tomorrow"){const a=new Date(u);a.setDate(a.getDate()+1);const l=new Date(a);if(l.setHours(23,59,59,999),!(r>=a&&r<=l))return!1}else if(d.due==="week"){const a=new Date(u);if(a.setDate(a.getDate()+7),!(r>=u&&r<=a))return!1}else if(d.due==="past"&&!(r<u&&!b(s)))return!1}else if(d.due!=="unscheduled")return!1}return!0}),[x,d,u,w]),q=h.useMemo(()=>{const s=new Set;return x.forEach(t=>{Array.isArray(t.assignedUsers)&&t.assignedUsers.forEach(n=>s.add(n.displayName||n.name||n.lineUserId)),t.assignee&&s.add(t.assignee.name||t.assignee.displayName||t.assignee.lineUserId)}),Array.from(s)},[x]),A=s=>m.filter(t=>{const n=g(t);return n?p(n).getTime()===p(s).getTime():!1}),$=s=>{const t=g(s);return b(s)?"completed":t&&t<u?"overdue":"pending"},_=h.useMemo(()=>m.filter(s=>{const t=g(s);return!t||b(s)?!1:t>w&&t<=E}).sort((s,t)=>(g(s)||0)-(g(t)||0)).slice(0,8),[m,w,E]),O=h.useMemo(()=>m.filter(s=>!g(s)&&!b(s)).slice(0,10),[m]),H=h.useMemo(()=>A(j),[j,m]),z=s=>s.toLocaleDateString("th-TH",{month:"long",year:"numeric"}),G=s=>s.toLocaleDateString("th-TH",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),P=s=>{const t=g(s);if(!t)return"ไม่มีกำหนด";const n=t.toLocaleDateString("th-TH",{month:"short",day:"numeric"});return s.dueTime?`${n} • ${s.dueTime}`:n},W=()=>{const s=new Date;N(s),L(p(s))},K=()=>{N(new Date)},B=()=>{const s=new Date(f);s.setMonth(s.getMonth()-1),N(s)},J=()=>{const s=new Date(f);s.setMonth(s.getMonth()+1),N(s)},D=h.useMemo(()=>{const s=m.length,t=m.filter(i=>!b(i)&&g(i)&&g(i)>=u).length,n=m.filter(i=>b(i)).length,c=m.filter(i=>{const r=g(i);return r&&r<u&&!b(i)}).length;return{total:s,inProgress:t,completed:n,overdue:c}},[m,u]);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"ปฏิทินงาน"}),e.jsx("p",{className:"text-muted-foreground",children:"ดูกำหนดการและสถานะงานทั้งหมดในรูปแบบรายเดือน"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:W,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border text-sm hover:bg-gray-50 transition",children:[e.jsx(de,{className:"w-4 h-4"}),"วันนี้"]}),e.jsxs("button",{type:"button",onClick:K,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border text-sm hover:bg-gray-50 transition",children:[e.jsx(Z,{className:"w-4 h-4"}),"เดือนนี้"]}),e.jsxs("button",{type:"button",onClick:()=>U&&U("normal"),className:"inline-flex items-center gap-2 rounded-md bg-blue-500 px-3 py-2 text-sm font-medium text-white hover:bg-blue-600 transition",children:[e.jsx(V,{className:"w-4 h-4"}),"เพิ่มงาน"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm px-6 py-4 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:B,className:"rounded-md border border-border p-2 hover:bg-gray-100 transition","aria-label":"เดือนก่อน",children:e.jsx(re,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-lg font-semibold min-w-[190px] text-center",children:z(f)}),e.jsx("button",{type:"button",onClick:J,className:"rounded-md border border-border p-2 hover:bg-gray-100 transition","aria-label":"เดือนถัดไป",children:e.jsx(ne,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-blue-500"}),"งานที่ต้องทำ"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-green-500"}),"เสร็จแล้ว"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-red-500"}),"เกินกำหนด"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-amber-500"}),"วันนี้"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4"}),"ตัวกรองงานในปฏิทิน"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx(te,{placeholder:"ค้นหาชื่องานหรือคำอธิบาย...",value:d.search,onChange:s=>y(t=>({...t,search:s.target.value})),className:"pl-9"})]}),e.jsxs(T,{value:d.status,onValueChange:s=>y(t=>({...t,status:s})),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"เลือกสถานะ"})}),e.jsxs(M,{children:[e.jsx(o,{value:"all",children:"สถานะ: ทั้งหมด"}),e.jsx(o,{value:"pending",children:"รอดำเนินการ"}),e.jsx(o,{value:"in_progress",children:"กำลังดำเนินการ"}),e.jsx(o,{value:"completed",children:"เสร็จแล้ว"}),e.jsx(o,{value:"overdue",children:"เกินกำหนด"})]})]}),e.jsxs(T,{value:d.priority,onValueChange:s=>y(t=>({...t,priority:s})),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"เลือกความสำคัญ"})}),e.jsxs(M,{children:[e.jsx(o,{value:"all",children:"ความสำคัญ: ทั้งหมด"}),e.jsx(o,{value:"low",children:"ต่ำ"}),e.jsx(o,{value:"medium",children:"ปานกลาง"}),e.jsx(o,{value:"high",children:"สูง"}),e.jsx(o,{value:"urgent",children:"เร่งด่วน"})]})]}),e.jsxs(T,{value:d.assignee,onValueChange:s=>y(t=>({...t,assignee:s})),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"เลือกผู้รับผิดชอบ"})}),e.jsxs(M,{children:[e.jsx(o,{value:"all",children:"ผู้รับผิดชอบ: ทั้งหมด"}),q.map(s=>e.jsx(o,{value:s,children:s},s))]})]}),e.jsxs(T,{value:d.due,onValueChange:s=>y(t=>({...t,due:s})),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"เลือกกำหนดส่ง"})}),e.jsxs(M,{children:[e.jsx(o,{value:"all",children:"กำหนดส่ง: ทั้งหมด"}),e.jsx(o,{value:"today",children:"วันนี้"}),e.jsx(o,{value:"tomorrow",children:"พรุ่งนี้"}),e.jsx(o,{value:"week",children:"7 วันข้างหน้า"}),e.jsx(o,{value:"past",children:"เกินกำหนด"}),e.jsx(o,{value:"unscheduled",children:"ยังไม่กำหนด"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"rounded-lg border border-blue-100 bg-blue-50 p-4",children:[e.jsx("p",{className:"text-xs text-blue-700",children:"งานที่แสดง"}),e.jsx("p",{className:"text-2xl font-semibold text-blue-700",children:D.total})]}),e.jsxs("div",{className:"rounded-lg border border-amber-100 bg-amber-50 p-4",children:[e.jsx("p",{className:"text-xs text-amber-700",children:"กำลังดำเนินการ"}),e.jsx("p",{className:"text-2xl font-semibold text-amber-700",children:D.inProgress})]}),e.jsxs("div",{className:"rounded-lg border border-green-100 bg-green-50 p-4",children:[e.jsx("p",{className:"text-xs text-green-700",children:"เสร็จสิ้นแล้ว"}),e.jsx("p",{className:"text-2xl font-semibold text-green-700",children:D.completed})]}),e.jsxs("div",{className:"rounded-lg border border-red-100 bg-red-50 p-4",children:[e.jsx("p",{className:"text-xs text-red-700",children:"เกินกำหนด"}),e.jsx("p",{className:"text-2xl font-semibold text-red-700",children:D.overdue})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-[2fr_1fr] gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 text-center text-xs font-semibold text-muted-foreground uppercase",children:oe.map(s=>e.jsx("div",{className:"py-2",children:s},s))}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:I.flat().map(({date:s,isCurrentMonth:t},n)=>{const c=A(s),i=p(s).getTime()===u.getTime(),r=p(s).getTime()===j.getTime();return e.jsxs("button",{type:"button",onClick:()=>L(p(s)),className:`min-h-[120px] rounded-lg border p-2 text-left transition ${r?"border-blue-500 bg-blue-50/40 ring-2 ring-blue-100":"border-gray-100 hover:border-blue-200 hover:bg-blue-50/30"} ${t?"bg-white":"bg-gray-50 text-gray-400"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm font-semibold ${i?"text-blue-600":"text-gray-700"}`,children:s.getDate()}),c.length>0&&e.jsxs("span",{className:"text-[11px] text-muted-foreground",children:[c.length," งาน"]})]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[c.slice(0,3).map(a=>{const l=$(a),Q=l==="completed"?"bg-green-100 text-green-700":l==="overdue"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700";return e.jsx("span",{className:`flex items-center gap-1 truncate rounded px-2 py-1 text-[11px] font-medium ${Q}`,children:a.title},a.id)}),c.length>3&&e.jsxs("span",{className:"text-[11px] text-muted-foreground",children:["+",c.length-3," งาน"]})]})]},`${s.toISOString()}-${n}`)})})]}),e.jsx("div",{className:"md:hidden space-y-2",children:I.flat().filter(({isCurrentMonth:s})=>s).map(({date:s},t)=>{const n=A(s),c=p(s).getTime()===u.getTime(),i=p(s).getTime()===j.getTime();return n.length===0&&!c&&!i?null:e.jsxs("button",{type:"button",onClick:()=>L(p(s)),className:`w-full rounded-lg border p-4 text-left transition ${i?"border-blue-500 bg-blue-50/40 ring-2 ring-blue-100":"border-gray-100 bg-white hover:border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-base font-semibold ${c?"text-blue-600":"text-gray-700"}`,children:s.toLocaleDateString("th-TH",{weekday:"short",day:"numeric",month:"short"})}),n.length>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[n.length," งาน"]})]}),n.length>0&&e.jsxs("div",{className:"space-y-1",children:[n.slice(0,2).map(r=>{const a=$(r),l=a==="completed"?"bg-green-100 text-green-700":a==="overdue"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700";return e.jsx("div",{className:`rounded px-3 py-2 text-sm font-medium ${l}`,children:r.title},r.id)}),n.length>2&&e.jsxs("p",{className:"text-sm text-muted-foreground pl-3",children:["+",n.length-2," งานอื่นๆ"]})]})]},`mobile-${s.toISOString()}-${t}`)})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 border-b px-5 py-4",children:[e.jsx(V,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"งานในวันที่เลือก"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:G(j)})]})]}),e.jsx("div",{className:"p-5",children:H.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 rounded-lg border border-dashed border-gray-200 px-4 py-6 text-sm text-muted-foreground",children:[e.jsx(k,{className:"h-5 w-5"}),"ยังไม่มีงานสำหรับวันนี้"]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:H.map(s=>e.jsx(ee,{task:s,onClick:()=>v(s)},s.id))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"งานที่กำลังจะถึง"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ภายใน 7 วันข้างหน้า"})]}),e.jsx(se,{className:"w-5 h-5 text-indigo-500"})]}),e.jsx("div",{className:"p-5 space-y-3",children:_.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"ไม่มีงานในช่วง 7 วันข้างหน้า"}):_.map(s=>e.jsxs("button",{type:"button",onClick:()=>v(s),className:"w-full rounded-lg border border-gray-100 px-4 py-3 text-left transition hover:bg-gray-50",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:P(s)})]},s.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"งานที่ยังไม่มีกำหนด"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"จัดตารางเวลาให้พร้อมก่อนส่ง"})]}),e.jsx(ie,{className:"w-5 h-5 text-amber-500"})]}),e.jsx("div",{className:"p-5 space-y-3",children:O.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"งานทั้งหมดถูกกำหนดวันที่เรียบร้อยแล้ว"}):O.map(s=>e.jsxs("button",{type:"button",onClick:()=>v(s),className:"w-full rounded-lg border border-dashed border-gray-200 px-4 py-3 text-left transition hover:border-blue-200 hover:bg-blue-50/30",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ยังไม่กำหนดวันส่ง"})]},s.id))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between border-b px-5 py-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"รายการงานตามตัวกรอง"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["แสดง ",m.length," งาน | คลิกแถวเพื่อเปิดรายละเอียด"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-left text-xs uppercase text-muted-foreground",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4",children:"ชื่องาน"}),e.jsx("th",{className:"py-3 px-4",children:"สถานะ"}),e.jsx("th",{className:"py-3 px-4",children:"ความสำคัญ"}),e.jsx("th",{className:"py-3 px-4",children:"กำหนดส่ง"}),e.jsx("th",{className:"py-3 px-4",children:"ผู้รับผิดชอบ"})]})}),e.jsx("tbody",{children:m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-10 text-center text-muted-foreground",children:"ไม่พบงานตามเงื่อนไขที่เลือก"})}):m.map(s=>{const t=(s.status||"").toLowerCase(),n=R[t]||R[t.replace("_","-")]||t,c=g(s),i=[];return Array.isArray(s.assignedUsers)&&i.push(...s.assignedUsers.map(r=>r.displayName||r.name||r.lineUserId)),s.assignee&&i.push(s.assignee.name||s.assignee.displayName||s.assignee.lineUserId||""),e.jsxs("tr",{className:"border-b last:border-0 hover:bg-gray-50 cursor-pointer",onClick:()=>v(s),children:[e.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:s.title}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-3 py-1 text-xs font-semibold text-blue-700",children:n})}),e.jsx("td",{className:"py-3 px-4 capitalize text-gray-600",children:s.priority||"-"}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:c?P(s):"ไม่กำหนด"}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:i.length>0?Array.from(new Set(i)).join(", "):"ไม่ระบุ"})]},s.id)})})]})})]})]})};export{Ne as default};
