const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CpPG0aiG.js","assets/index-5vmtZ3h8.css"])))=>i.map(i=>d[i]);
import{c as bt,m as mt,r as a,j as l,n as Pt,d as zt,s as Je,R as B,o as Ae,p as Nn,_ as jn,q as En,t as Mn,T as Tn,u as In,v as An}from"./index-CpPG0aiG.js";import{S as kt}from"./pagination-D8_ikiov.js";import{M as On}from"./mail-CEkYu_27.js";import{C as Ln}from"./circle-check-big-CE0WcXp5.js";import{P as Pn}from"./plus-C2aBFpVH.js";import{L as zn}from"./layout-grid-ChW-1859.js";import{F as kn}from"./filter-Dxr3evqs.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=bt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=bt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=bt("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),ue=20,$n=({tasks:e=[],onTaskClick:t,onCreateTask:n})=>{const{canModify:r}=mt(),[s,o]=a.useState({active:!0,completed:!1}),[c,i]=a.useState(1),[u,g]=a.useState(1),h=new Set(["completed","approved","submitted","reviewed","auto_approved","cancelled"]),p=d=>{if(!d)return"pending";const m=d.toLowerCase();return m==="in-progress"?"in_progress":m==="waiting"?"pending":m==="approved"||m==="submitted"||m==="reviewed"||m==="auto_approved"?"completed":m==="cancelled"?"cancelled":m},x=e.filter(d=>!h.has(d.status)),v=e.filter(d=>h.has(d.status)),E=Math.ceil(x.length/ue),C=a.useMemo(()=>{const d=(c-1)*ue,m=d+ue;return x.slice(d,m)},[x,c]),b=Math.ceil(v.length/ue),D=a.useMemo(()=>{const d=(u-1)*ue,m=d+ue;return v.slice(d,m)},[v,u]),R=d=>{o(m=>({...m,[d]:!m[d]}))},w=d=>{const m=d==null?void 0:d.replace("_","-"),M={pending:{class:"bg-blue-100 text-blue-700",label:"รอดำเนินการ"},scheduled:{class:"bg-blue-100 text-blue-700",label:"รอกำหนดส่ง"},"in-progress":{class:"bg-amber-100 text-amber-700",label:"กำลังดำเนินการ"},in_progress:{class:"bg-amber-100 text-amber-700",label:"กำลังดำเนินการ"},completed:{class:"bg-green-100 text-green-700",label:"เสร็จแล้ว"},approved:{class:"bg-green-100 text-green-700",label:"อนุมัติแล้ว"},submitted:{class:"bg-green-100 text-green-700",label:"ส่งแล้ว"},reviewed:{class:"bg-green-100 text-green-700",label:"ตรวจแล้ว"},overdue:{class:"bg-red-100 text-red-700",label:"เกินกำหนด"},cancelled:{class:"bg-gray-200 text-gray-700",label:"ยกเลิก"}};return M[m]||M.pending},N=d=>{var M;const m={operational:"งานทั่วไป",report:"รายงาน",meeting:"การประชุม",project:"โครงการ",maintenance:"บำรุงรักษา"};return d&&(m[d]||m[(M=d==null?void 0:d.toLowerCase)==null?void 0:M.call(d)]||d)||"อื่นๆ"},j=d=>{if(!d)return"ไม่กำหนด";try{return new Date(d).toLocaleDateString("th-TH",{dateStyle:"medium"})}catch{return d}},f=d=>{const m=[];Array.isArray(d.assignedUsers)&&d.assignedUsers.forEach(S=>m.push(S.displayName||S.name||S.lineUserId)),d.assignee&&m.push(d.assignee.name||d.assignee.displayName||d.assignee.lineUserId);const M=m.filter(Boolean);return M.length===0?"ไม่ระบุ":Array.from(new Set(M)).join(", ")},y=({task:d,onClick:m})=>{const M=w(p(d.status));return l.jsxs("div",{role:"button",tabIndex:0,onClick:()=>m&&m(d),onKeyDown:S=>{(S.key==="Enter"||S.key===" ")&&(S.preventDefault(),m&&m(d))},className:"grid grid-cols-[3fr_1.5fr_1fr_1fr_0.5fr] gap-4 px-4 py-3 border-b border-border hover:bg-gray-100 transition-colors cursor-pointer",children:[l.jsx("div",{className:"font-medium text-sm",children:d.title}),l.jsx("div",{children:l.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${M.class}`,children:M.label})}),l.jsx("div",{className:"text-sm text-gray-600",children:N(d.type)}),l.jsx("div",{className:"text-sm text-gray-600",children:j(d.dueDate||d.scheduledDate)}),l.jsx("div",{className:"flex justify-end",children:l.jsx("span",{className:"text-sm text-gray-600 truncate max-w-[120px]",children:f(d)})})]})};return l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 cursor-pointer hover:bg-gray-50",onClick:()=>R("active"),children:[s.active?l.jsx(Pt,{size:20}):l.jsx(zt,{size:20}),l.jsx("h3",{className:"font-semibold",children:"งานที่ยังเปิดอยู่"}),l.jsx("span",{className:"text-sm text-gray-500",children:x.length})]}),s.active&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-[3fr_1.5fr_1fr_1fr_0.5fr] gap-4 px-4 py-2 bg-gray-50 text-sm font-medium text-gray-600",children:[l.jsx("div",{children:"ชื่องาน"}),l.jsx("div",{children:"สถานะ"}),l.jsx("div",{children:"ประเภท"}),l.jsx("div",{children:"กำหนดส่ง"}),l.jsx("div",{className:"text-right",children:"ผู้รับผิดชอบ"})]}),C.length>0?C.map(d=>l.jsx(y,{task:d,onClick:t},d.id)):l.jsx("div",{className:"px-4 py-8 text-center text-muted-foreground",children:"ไม่มีงานที่ยังเปิดอยู่"}),E>1&&l.jsx(kt,{currentPage:c,totalPages:E,onPageChange:i,totalItems:x.length,itemsPerPage:ue}),l.jsx("div",{className:"px-4 py-3 border-t",children:l.jsx("button",{type:"button",onClick:()=>{if(!r()){Je("คุณไม่มีสิทธิ์สร้างงาน - กรุณาเข้าผ่าน LINE ส่วนตัว");return}n&&n()},disabled:!r(),className:"text-sm text-blue-500 hover:text-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",title:r()?"เพิ่มงาน":"ไม่มีสิทธิ์สร้างงาน",children:"+ เพิ่มงาน"})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 cursor-pointer hover:bg-gray-50",onClick:()=>R("completed"),children:[s.completed?l.jsx(Pt,{size:20}):l.jsx(zt,{size:20}),l.jsx("h3",{className:"font-semibold",children:"งานที่เสร็จแล้ว"}),l.jsx("span",{className:"text-sm text-gray-500",children:v.length})]}),s.completed&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-[3fr_1.5fr_1fr_1fr_0.5fr] gap-4 px-4 py-2 bg-gray-50 text-sm font-medium text-gray-600",children:[l.jsx("div",{children:"ชื่องาน"}),l.jsx("div",{children:"สถานะ"}),l.jsx("div",{children:"ประเภท"}),l.jsx("div",{children:"กำหนดส่ง"}),l.jsx("div",{className:"text-right",children:"ผู้รับผิดชอบ"})]}),D.length>0?D.map(d=>l.jsx(y,{task:d,onClick:t},d.id)):l.jsx("div",{className:"px-4 py-8 text-center text-muted-foreground",children:"ไม่มีงานที่เสร็จแล้ว"}),b>1&&l.jsx(kt,{currentPage:u,totalPages:b,onPageChange:g,totalItems:v.length,itemsPerPage:ue})]})]})]})};function Un(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const nt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function we(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function xt(e){return"nodeType"in e}function _(e){var t,n;return e?we(e)?e:xt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function yt(e){const{Document:t}=_(e);return e instanceof t}function _e(e){return we(e)?!1:e instanceof _(e).HTMLElement}function Gt(e){return e instanceof _(e).SVGElement}function De(e){return e?we(e)?e.document:xt(e)?yt(e)?e:_e(e)||Gt(e)?e.ownerDocument:document:document:document}const Z=nt?a.useLayoutEffect:a.useEffect;function wt(e){const t=a.useRef(e);return Z(()=>{t.current=e}),a.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function Xn(){const e=a.useRef(null),t=a.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=a.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function ze(e,t){t===void 0&&(t=[e]);const n=a.useRef(e);return Z(()=>{n.current!==e&&(n.current=e)},t),n}function Fe(e,t){const n=a.useRef();return a.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Qe(e){const t=wt(e),n=a.useRef(null),r=a.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function ft(e){const t=a.useRef();return a.useEffect(()=>{t.current=e},[e]),t.current}let lt={};function $e(e,t){return a.useMemo(()=>{if(t)return t;const n=lt[e]==null?0:lt[e]+1;return lt[e]=n,e+"-"+n},[e,t])}function Jt(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((o,c)=>{const i=Object.entries(c);for(const[u,g]of i){const h=o[u];h!=null&&(o[u]=h+e*g)}return o},{...t})}}const ye=Jt(1),Ze=Jt(-1);function Wn(e){return"clientX"in e&&"clientY"in e}function Dt(e){if(!e)return!1;const{KeyboardEvent:t}=_(e.target);return t&&e instanceof t}function Yn(e){if(!e)return!1;const{TouchEvent:t}=_(e.target);return t&&e instanceof t}function gt(e){if(Yn(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Wn(e)?{x:e.clientX,y:e.clientY}:null}const ke=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[ke.Translate.toString(e),ke.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Bt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Hn(e){return e.matches(Bt)?e:e.querySelector(Bt)}const Vn={display:"none"};function Kn(e){let{id:t,value:n}=e;return B.createElement("div",{id:t,style:Vn},n)}function qn(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return B.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function Gn(){const[e,t]=a.useState("");return{announce:a.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Qt=a.createContext(null);function Jn(e){const t=a.useContext(Qt);a.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Qn(){const[e]=a.useState(()=>new Set),t=a.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[a.useCallback(r=>{let{type:s,event:o}=r;e.forEach(c=>{var i;return(i=c[s])==null?void 0:i.call(c,o)})},[e]),t]}const Zn={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},er={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function tr(e){let{announcements:t=er,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=Zn}=e;const{announce:o,announcement:c}=Gn(),i=$e("DndLiveRegion"),[u,g]=a.useState(!1);if(a.useEffect(()=>{g(!0)},[]),Jn(a.useMemo(()=>({onDragStart(p){let{active:x}=p;o(t.onDragStart({active:x}))},onDragMove(p){let{active:x,over:v}=p;t.onDragMove&&o(t.onDragMove({active:x,over:v}))},onDragOver(p){let{active:x,over:v}=p;o(t.onDragOver({active:x,over:v}))},onDragEnd(p){let{active:x,over:v}=p;o(t.onDragEnd({active:x,over:v}))},onDragCancel(p){let{active:x,over:v}=p;o(t.onDragCancel({active:x,over:v}))}}),[o,t])),!u)return null;const h=B.createElement(B.Fragment,null,B.createElement(Kn,{id:r,value:s.draggable}),B.createElement(qn,{id:i,announcement:c}));return n?Ae.createPortal(h,n):h}var A;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(A||(A={}));function et(){}function nr(e,t){return a.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function rr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const K=Object.freeze({x:0,y:0});function sr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function or(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function ir(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function _t(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function ar(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const lr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=_t(t),o=[];for(const c of r){const{id:i}=c,u=n.get(i);if(u){const g=_t(u),h=s.reduce((x,v,E)=>x+sr(g[E],v),0),p=Number((h/4).toFixed(4));o.push({id:i,data:{droppableContainer:c,value:p}})}}return o.sort(or)};function cr(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),c=s-r,i=o-n;if(r<s&&n<o){const u=t.width*t.height,g=e.width*e.height,h=c*i,p=h/(u+g-h);return Number(p.toFixed(4))}return 0}const dr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const o of r){const{id:c}=o,i=n.get(c);if(i){const u=cr(i,t);u>0&&s.push({id:c,data:{droppableContainer:o,value:u}})}}return s.sort(ir)};function ur(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Zt(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:K}function fr(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return s.reduce((c,i)=>({...c,top:c.top+e*i.y,bottom:c.bottom+e*i.y,left:c.left+e*i.x,right:c.right+e*i.x}),{...n})}}const gr=fr(1);function hr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function pr(e,t,n){const r=hr(t);if(!r)return e;const{scaleX:s,scaleY:o,x:c,y:i}=r,u=e.left-c-(1-s)*parseFloat(n),g=e.top-i-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),h=s?e.width/s:e.width,p=o?e.height/o:e.height;return{width:h,height:p,top:g,right:u+h,bottom:g+p,left:u}}const vr={ignoreTransform:!1};function Ce(e,t){t===void 0&&(t=vr);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:g,transformOrigin:h}=_(e).getComputedStyle(e);g&&(n=pr(n,g,h))}const{top:r,left:s,width:o,height:c,bottom:i,right:u}=n;return{top:r,left:s,width:o,height:c,bottom:i,right:u}}function Ft(e){return Ce(e,{ignoreTransform:!0})}function br(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function mr(e,t){return t===void 0&&(t=_(e).getComputedStyle(e)),t.position==="fixed"}function xr(e,t){t===void 0&&(t=_(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const o=t[s];return typeof o=="string"?n.test(o):!1})}function Ct(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(yt(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!_e(s)||Gt(s)||n.includes(s))return n;const o=_(e).getComputedStyle(s);return s!==e&&xr(s,o)&&n.push(s),mr(s,o)?n:r(s.parentNode)}return e?r(e):n}function en(e){const[t]=Ct(e,1);return t??null}function ct(e){return!nt||!e?null:we(e)?e:xt(e)?yt(e)||e===De(e).scrollingElement?window:_e(e)?e:null:null}function tn(e){return we(e)?e.scrollX:e.scrollLeft}function nn(e){return we(e)?e.scrollY:e.scrollTop}function ht(e){return{x:tn(e),y:nn(e)}}var O;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(O||(O={}));function rn(e){return!nt||!e?!1:e===document.scrollingElement}function sn(e){const t={x:0,y:0},n=rn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,c=e.scrollTop>=r.y,i=e.scrollLeft>=r.x;return{isTop:s,isLeft:o,isBottom:c,isRight:i,maxScroll:r,minScroll:t}}const yr={x:.2,y:.2};function wr(e,t,n,r,s){let{top:o,left:c,right:i,bottom:u}=n;r===void 0&&(r=10),s===void 0&&(s=yr);const{isTop:g,isBottom:h,isLeft:p,isRight:x}=sn(e),v={x:0,y:0},E={x:0,y:0},C={height:t.height*s.y,width:t.width*s.x};return!g&&o<=t.top+C.height?(v.y=O.Backward,E.y=r*Math.abs((t.top+C.height-o)/C.height)):!h&&u>=t.bottom-C.height&&(v.y=O.Forward,E.y=r*Math.abs((t.bottom-C.height-u)/C.height)),!x&&i>=t.right-C.width?(v.x=O.Forward,E.x=r*Math.abs((t.right-C.width-i)/C.width)):!p&&c<=t.left+C.width&&(v.x=O.Backward,E.x=r*Math.abs((t.left+C.width-c)/C.width)),{direction:v,speed:E}}function Dr(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:c}=window;return{top:0,left:0,right:o,bottom:c,width:o,height:c}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function on(e){return e.reduce((t,n)=>ye(t,ht(n)),K)}function Cr(e){return e.reduce((t,n)=>t+tn(n),0)}function Sr(e){return e.reduce((t,n)=>t+nn(n),0)}function Rr(e,t){if(t===void 0&&(t=Ce),!e)return;const{top:n,left:r,bottom:s,right:o}=t(e);en(e)&&(s<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Nr=[["x",["left","right"],Cr],["y",["top","bottom"],Sr]];class St{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Ct(n),s=on(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,c,i]of Nr)for(const u of c)Object.defineProperty(this,u,{get:()=>{const g=i(r),h=s[o]-g;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Oe{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function jr(e){const{EventTarget:t}=_(e);return e instanceof t?e:De(e)}function dt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var H;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(H||(H={}));function $t(e){e.preventDefault()}function Er(e){e.stopPropagation()}var T;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(T||(T={}));const an={start:[T.Space,T.Enter],cancel:[T.Esc],end:[T.Space,T.Enter,T.Tab]},Mr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case T.Right:return{...n,x:n.x+25};case T.Left:return{...n,x:n.x-25};case T.Down:return{...n,y:n.y+25};case T.Up:return{...n,y:n.y-25}}};class ln{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Oe(De(n)),this.windowListeners=new Oe(_(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(H.Resize,this.handleCancel),this.windowListeners.add(H.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(H.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Rr(r),n(K)}handleKeyDown(t){if(Dt(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:o=an,coordinateGetter:c=Mr,scrollBehavior:i="smooth"}=s,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:g}=r.current,h=g?{x:g.left,y:g.top}:K;this.referenceCoordinates||(this.referenceCoordinates=h);const p=c(t,{active:n,context:r.current,currentCoordinates:h});if(p){const x=Ze(p,h),v={x:0,y:0},{scrollableAncestors:E}=r.current;for(const C of E){const b=t.code,{isTop:D,isRight:R,isLeft:w,isBottom:N,maxScroll:j,minScroll:f}=sn(C),y=Dr(C),d={x:Math.min(b===T.Right?y.right-y.width/2:y.right,Math.max(b===T.Right?y.left:y.left+y.width/2,p.x)),y:Math.min(b===T.Down?y.bottom-y.height/2:y.bottom,Math.max(b===T.Down?y.top:y.top+y.height/2,p.y))},m=b===T.Right&&!R||b===T.Left&&!w,M=b===T.Down&&!N||b===T.Up&&!D;if(m&&d.x!==p.x){const S=C.scrollLeft+x.x,L=b===T.Right&&S<=j.x||b===T.Left&&S>=f.x;if(L&&!x.y){C.scrollTo({left:S,behavior:i});return}L?v.x=C.scrollLeft-S:v.x=b===T.Right?C.scrollLeft-j.x:C.scrollLeft-f.x,v.x&&C.scrollBy({left:-v.x,behavior:i});break}else if(M&&d.y!==p.y){const S=C.scrollTop+x.y,L=b===T.Down&&S<=j.y||b===T.Up&&S>=f.y;if(L&&!x.x){C.scrollTo({top:S,behavior:i});return}L?v.y=C.scrollTop-S:v.y=b===T.Down?C.scrollTop-j.y:C.scrollTop-f.y,v.y&&C.scrollBy({top:-v.y,behavior:i});break}}this.handleMove(t,ye(Ze(p,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ln.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=an,onActivation:s}=t,{active:o}=n;const{code:c}=e.nativeEvent;if(r.start.includes(c)){const i=o.activatorNode.current;return i&&e.target!==i?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function Ut(e){return!!(e&&"distance"in e)}function Xt(e){return!!(e&&"delay"in e)}class Rt{constructor(t,n,r){var s;r===void 0&&(r=jr(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:c}=o;this.props=t,this.events=n,this.document=De(c),this.documentListeners=new Oe(this.document),this.listeners=new Oe(r),this.windowListeners=new Oe(_(c)),this.initialCoordinates=(s=gt(o))!=null?s:K,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(H.Resize,this.handleCancel),this.windowListeners.add(H.DragStart,$t),this.windowListeners.add(H.VisibilityChange,this.handleCancel),this.windowListeners.add(H.ContextMenu,$t),this.documentListeners.add(H.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Xt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Ut(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(H.Click,Er,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(H.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:o}=this,{onMove:c,options:{activationConstraint:i}}=o;if(!s)return;const u=(n=gt(t))!=null?n:K,g=Ze(s,u);if(!r&&i){if(Ut(i)){if(i.tolerance!=null&&dt(g,i.tolerance))return this.handleCancel();if(dt(g,i.distance))return this.handleStart()}if(Xt(i)&&dt(g,i.tolerance))return this.handleCancel();this.handlePending(i,g);return}t.cancelable&&t.preventDefault(),c(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===T.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Tr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Nt extends Rt{constructor(t){const{event:n}=t,r=De(n.target);super(t,Tr,r)}}Nt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Ir={move:{name:"mousemove"},end:{name:"mouseup"}};var pt;(function(e){e[e.RightClick=2]="RightClick"})(pt||(pt={}));class Ar extends Rt{constructor(t){super(t,Ir,De(t.event.target))}}Ar.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===pt.RightClick?!1:(r==null||r({event:n}),!0)}}];const ut={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Or extends Rt{constructor(t){super(t,ut)}static setup(){return window.addEventListener(ut.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(ut.move.name,t)};function t(){}}}Or.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var Le;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Le||(Le={}));var tt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(tt||(tt={}));function Lr(e){let{acceleration:t,activator:n=Le.Pointer,canScroll:r,draggingRect:s,enabled:o,interval:c=5,order:i=tt.TreeOrder,pointerCoordinates:u,scrollableAncestors:g,scrollableAncestorRects:h,delta:p,threshold:x}=e;const v=zr({delta:p,disabled:!o}),[E,C]=Xn(),b=a.useRef({x:0,y:0}),D=a.useRef({x:0,y:0}),R=a.useMemo(()=>{switch(n){case Le.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Le.DraggableRect:return s}},[n,s,u]),w=a.useRef(null),N=a.useCallback(()=>{const f=w.current;if(!f)return;const y=b.current.x*D.current.x,d=b.current.y*D.current.y;f.scrollBy(y,d)},[]),j=a.useMemo(()=>i===tt.TreeOrder?[...g].reverse():g,[i,g]);a.useEffect(()=>{if(!o||!g.length||!R){C();return}for(const f of j){if((r==null?void 0:r(f))===!1)continue;const y=g.indexOf(f),d=h[y];if(!d)continue;const{direction:m,speed:M}=wr(f,d,R,t,x);for(const S of["x","y"])v[S][m[S]]||(M[S]=0,m[S]=0);if(M.x>0||M.y>0){C(),w.current=f,E(N,c),b.current=M,D.current=m;return}}b.current={x:0,y:0},D.current={x:0,y:0},C()},[t,N,r,C,o,c,JSON.stringify(R),JSON.stringify(v),E,g,j,h,JSON.stringify(x)])}const Pr={x:{[O.Backward]:!1,[O.Forward]:!1},y:{[O.Backward]:!1,[O.Forward]:!1}};function zr(e){let{delta:t,disabled:n}=e;const r=ft(t);return Fe(s=>{if(n||!r||!s)return Pr;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[O.Backward]:s.x[O.Backward]||o.x===-1,[O.Forward]:s.x[O.Forward]||o.x===1},y:{[O.Backward]:s.y[O.Backward]||o.y===-1,[O.Forward]:s.y[O.Forward]||o.y===1}}},[n,t,r])}function kr(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Fe(s=>{var o;return t==null?null:(o=r??s)!=null?o:null},[r,t])}function Br(e,t){return a.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,o=s.activators.map(c=>({eventName:c.eventName,handler:t(c.handler,r)}));return[...n,...o]},[]),[e,t])}var Be;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Be||(Be={}));var vt;(function(e){e.Optimized="optimized"})(vt||(vt={}));const Wt=new Map;function _r(e,t){let{dragging:n,dependencies:r,config:s}=t;const[o,c]=a.useState(null),{frequency:i,measure:u,strategy:g}=s,h=a.useRef(e),p=b(),x=ze(p),v=a.useCallback(function(D){D===void 0&&(D=[]),!x.current&&c(R=>R===null?D:R.concat(D.filter(w=>!R.includes(w))))},[x]),E=a.useRef(null),C=Fe(D=>{if(p&&!n)return Wt;if(!D||D===Wt||h.current!==e||o!=null){const R=new Map;for(let w of e){if(!w)continue;if(o&&o.length>0&&!o.includes(w.id)&&w.rect.current){R.set(w.id,w.rect.current);continue}const N=w.node.current,j=N?new St(u(N),N):null;w.rect.current=j,j&&R.set(w.id,j)}return R}return D},[e,o,n,p,u]);return a.useEffect(()=>{h.current=e},[e]),a.useEffect(()=>{p||v()},[n,p]),a.useEffect(()=>{o&&o.length>0&&c(null)},[JSON.stringify(o)]),a.useEffect(()=>{p||typeof i!="number"||E.current!==null||(E.current=setTimeout(()=>{v(),E.current=null},i))},[i,p,v,...r]),{droppableRects:C,measureDroppableContainers:v,measuringScheduled:o!=null};function b(){switch(g){case Be.Always:return!1;case Be.BeforeDragging:return n;default:return!n}}}function cn(e,t){return Fe(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Fr(e,t){return cn(e,t)}function $r(e){let{callback:t,disabled:n}=e;const r=wt(t),s=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return a.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function rt(e){let{callback:t,disabled:n}=e;const r=wt(t),s=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return a.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Ur(e){return new St(Ce(e),e)}function Yt(e,t,n){t===void 0&&(t=Ur);const[r,s]=a.useState(null);function o(){s(u=>{if(!e)return null;if(e.isConnected===!1){var g;return(g=u??n)!=null?g:null}const h=t(e);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const c=$r({callback(u){if(e)for(const g of u){const{type:h,target:p}=g;if(h==="childList"&&p instanceof HTMLElement&&p.contains(e)){o();break}}}}),i=rt({callback:o});return Z(()=>{o(),e?(i==null||i.observe(e),c==null||c.observe(document.body,{childList:!0,subtree:!0})):(i==null||i.disconnect(),c==null||c.disconnect())},[e]),r}function Xr(e){const t=cn(e);return Zt(e,t)}const Ht=[];function Wr(e){const t=a.useRef(e),n=Fe(r=>e?r&&r!==Ht&&e&&t.current&&e.parentNode===t.current.parentNode?r:Ct(e):Ht,[e]);return a.useEffect(()=>{t.current=e},[e]),n}function Yr(e){const[t,n]=a.useState(null),r=a.useRef(e),s=a.useCallback(o=>{const c=ct(o.target);c&&n(i=>i?(i.set(c,ht(c)),new Map(i)):null)},[]);return a.useEffect(()=>{const o=r.current;if(e!==o){c(o);const i=e.map(u=>{const g=ct(u);return g?(g.addEventListener("scroll",s,{passive:!0}),[g,ht(g)]):null}).filter(u=>u!=null);n(i.length?new Map(i):null),r.current=e}return()=>{c(e),c(o)};function c(i){i.forEach(u=>{const g=ct(u);g==null||g.removeEventListener("scroll",s)})}},[s,e]),a.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,c)=>ye(o,c),K):on(e):K,[e,t])}function Vt(e,t){t===void 0&&(t=[]);const n=a.useRef(null);return a.useEffect(()=>{n.current=null},t),a.useEffect(()=>{const r=e!==K;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Ze(e,n.current):K}function Hr(e){a.useEffect(()=>{if(!nt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Vr(e,t){return a.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:o}=r;return n[s]=c=>{o(c,t)},n},{}),[e,t])}function dn(e){return a.useMemo(()=>e?br(e):null,[e])}const Kt=[];function Kr(e,t){t===void 0&&(t=Ce);const[n]=e,r=dn(n?_(n):null),[s,o]=a.useState(Kt);function c(){o(()=>e.length?e.map(u=>rn(u)?r:new St(t(u),u)):Kt)}const i=rt({callback:c});return Z(()=>{i==null||i.disconnect(),c(),e.forEach(u=>i==null?void 0:i.observe(u))},[e]),s}function qr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return _e(t)?t:e}function Gr(e){let{measure:t}=e;const[n,r]=a.useState(null),s=a.useCallback(g=>{for(const{target:h}of g)if(_e(h)){r(p=>{const x=t(h);return p?{...p,width:x.width,height:x.height}:x});break}},[t]),o=rt({callback:s}),c=a.useCallback(g=>{const h=qr(g);o==null||o.disconnect(),h&&(o==null||o.observe(h)),r(h?t(h):null)},[t,o]),[i,u]=Qe(c);return a.useMemo(()=>({nodeRef:i,rect:n,setRef:u}),[n,i,u])}const Jr=[{sensor:Nt,options:{}},{sensor:ln,options:{}}],Qr={current:{}},Ge={draggable:{measure:Ft},droppable:{measure:Ft,strategy:Be.WhileDragging,frequency:vt.Optimized},dragOverlay:{measure:Ce}};class Pe extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Zr={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Pe,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:et},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ge,measureDroppableContainers:et,windowRect:null,measuringScheduled:!1},es={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:et,draggableNodes:new Map,over:null,measureDroppableContainers:et},st=a.createContext(es),un=a.createContext(Zr);function ts(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Pe}}}function ns(e,t){switch(t.type){case A.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case A.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case A.DragEnd:case A.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case A.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Pe(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case A.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const c=new Pe(e.droppable.containers);return c.set(n,{...o,disabled:s}),{...e,droppable:{...e.droppable,containers:c}}}case A.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const o=new Pe(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function rs(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=a.useContext(st),o=ft(r),c=ft(n==null?void 0:n.id);return a.useEffect(()=>{if(!t&&!r&&o&&c!=null){if(!Dt(o)||document.activeElement===o.target)return;const i=s.get(c);if(!i)return;const{activatorNode:u,node:g}=i;if(!u.current&&!g.current)return;requestAnimationFrame(()=>{for(const h of[u.current,g.current]){if(!h)continue;const p=Hn(h);if(p){p.focus();break}}})}},[r,t,s,c,o]),null}function ss(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,o)=>o({transform:s,...r}),n):n}function os(e){return a.useMemo(()=>({draggable:{...Ge.draggable,...e==null?void 0:e.draggable},droppable:{...Ge.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Ge.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function is(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const o=a.useRef(!1),{x:c,y:i}=typeof s=="boolean"?{x:s,y:s}:s;Z(()=>{if(!c&&!i||!t){o.current=!1;return}if(o.current||!r)return;const g=t==null?void 0:t.node.current;if(!g||g.isConnected===!1)return;const h=n(g),p=Zt(h,r);if(c||(p.x=0),i||(p.y=0),o.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const x=en(g);x&&x.scrollBy({top:p.y,left:p.x})}},[t,c,i,r,n])}const fn=a.createContext({...K,scaleX:1,scaleY:1});var fe;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(fe||(fe={}));const as=a.memo(function(t){var n,r,s,o;let{id:c,accessibility:i,autoScroll:u=!0,children:g,sensors:h=Jr,collisionDetection:p=dr,measuring:x,modifiers:v,...E}=t;const C=a.useReducer(ns,void 0,ts),[b,D]=C,[R,w]=Qn(),[N,j]=a.useState(fe.Uninitialized),f=N===fe.Initialized,{draggable:{active:y,nodes:d,translate:m},droppable:{containers:M}}=b,S=y!=null?d.get(y):null,L=a.useRef({initial:null,translated:null}),V=a.useMemo(()=>{var z;return y!=null?{id:y,data:(z=S==null?void 0:S.data)!=null?z:Qr,rect:L}:null},[y,S]),q=a.useRef(null),[Se,Ue]=a.useState(null),[F,Xe]=a.useState(null),ee=ze(E,Object.values(E)),Re=$e("DndDescribedBy",c),We=a.useMemo(()=>M.getEnabled(),[M]),k=os(x),{droppableRects:te,measureDroppableContainers:ge,measuringScheduled:Ne}=_r(We,{dragging:f,dependencies:[m.x,m.y],config:k.droppable}),W=kr(d,y),Ye=a.useMemo(()=>F?gt(F):null,[F]),oe=Rn(),ne=Fr(W,k.draggable.measure);is({activeNode:y!=null?d.get(y):null,config:oe.layoutShiftCompensation,initialRect:ne,measure:k.draggable.measure});const I=Yt(W,k.draggable.measure,ne),je=Yt(W?W.parentElement:null),G=a.useRef({activatorEvent:null,active:null,activeNode:W,collisionRect:null,collisions:null,droppableRects:te,draggableNodes:d,draggingNode:null,draggingNodeRect:null,droppableContainers:M,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),he=M.getNodeFor((n=G.current.over)==null?void 0:n.id),re=Gr({measure:k.dragOverlay.measure}),pe=(r=re.nodeRef.current)!=null?r:W,ve=f?(s=re.rect)!=null?s:I:null,jt=!!(re.nodeRef.current&&re.rect),Et=Xr(jt?null:I),ot=dn(pe?_(pe):null),ie=Wr(f?he??W:null),He=Kr(ie),Ve=ss(v,{transform:{x:m.x-Et.x,y:m.y-Et.y,scaleX:1,scaleY:1},activatorEvent:F,active:V,activeNodeRect:I,containerNodeRect:je,draggingNodeRect:ve,over:G.current.over,overlayNodeRect:re.rect,scrollableAncestors:ie,scrollableAncestorRects:He,windowRect:ot}),Mt=Ye?ye(Ye,m):null,Tt=Yr(ie),mn=Vt(Tt),xn=Vt(Tt,[I]),be=ye(Ve,mn),me=ve?gr(ve,Ve):null,Ee=V&&me?p({active:V,collisionRect:me,droppableRects:te,droppableContainers:We,pointerCoordinates:Mt}):null,It=ar(Ee,"id"),[ae,At]=a.useState(null),yn=jt?Ve:ye(Ve,xn),wn=ur(yn,(o=ae==null?void 0:ae.rect)!=null?o:null,I),it=a.useRef(null),Ot=a.useCallback((z,$)=>{let{sensor:U,options:le}=$;if(q.current==null)return;const Y=d.get(q.current);if(!Y)return;const X=z.nativeEvent,J=new U({active:q.current,activeNode:Y,event:X,options:le,context:G,onAbort(P){if(!d.get(P))return;const{onDragAbort:Q}=ee.current,se={id:P};Q==null||Q(se),R({type:"onDragAbort",event:se})},onPending(P,ce,Q,se){if(!d.get(P))return;const{onDragPending:Te}=ee.current,de={id:P,constraint:ce,initialCoordinates:Q,offset:se};Te==null||Te(de),R({type:"onDragPending",event:de})},onStart(P){const ce=q.current;if(ce==null)return;const Q=d.get(ce);if(!Q)return;const{onDragStart:se}=ee.current,Me={activatorEvent:X,active:{id:ce,data:Q.data,rect:L}};Ae.unstable_batchedUpdates(()=>{se==null||se(Me),j(fe.Initializing),D({type:A.DragStart,initialCoordinates:P,active:ce}),R({type:"onDragStart",event:Me}),Ue(it.current),Xe(X)})},onMove(P){D({type:A.DragMove,coordinates:P})},onEnd:xe(A.DragEnd),onCancel:xe(A.DragCancel)});it.current=J;function xe(P){return async function(){const{active:Q,collisions:se,over:Me,scrollAdjustedTranslate:Te}=G.current;let de=null;if(Q&&Te){const{cancelDrop:Ie}=ee.current;de={activatorEvent:X,active:Q,collisions:se,delta:Te,over:Me},P===A.DragEnd&&typeof Ie=="function"&&await Promise.resolve(Ie(de))&&(P=A.DragCancel)}q.current=null,Ae.unstable_batchedUpdates(()=>{D({type:P}),j(fe.Uninitialized),At(null),Ue(null),Xe(null),it.current=null;const Ie=P===A.DragEnd?"onDragEnd":"onDragCancel";if(de){const at=ee.current[Ie];at==null||at(de),R({type:Ie,event:de})}})}}},[d]),Dn=a.useCallback((z,$)=>(U,le)=>{const Y=U.nativeEvent,X=d.get(le);if(q.current!==null||!X||Y.dndKit||Y.defaultPrevented)return;const J={active:X};z(U,$.options,J)===!0&&(Y.dndKit={capturedBy:$.sensor},q.current=le,Ot(U,$))},[d,Ot]),Lt=Br(h,Dn);Hr(h),Z(()=>{I&&N===fe.Initializing&&j(fe.Initialized)},[I,N]),a.useEffect(()=>{const{onDragMove:z}=ee.current,{active:$,activatorEvent:U,collisions:le,over:Y}=G.current;if(!$||!U)return;const X={active:$,activatorEvent:U,collisions:le,delta:{x:be.x,y:be.y},over:Y};Ae.unstable_batchedUpdates(()=>{z==null||z(X),R({type:"onDragMove",event:X})})},[be.x,be.y]),a.useEffect(()=>{const{active:z,activatorEvent:$,collisions:U,droppableContainers:le,scrollAdjustedTranslate:Y}=G.current;if(!z||q.current==null||!$||!Y)return;const{onDragOver:X}=ee.current,J=le.get(It),xe=J&&J.rect.current?{id:J.id,rect:J.rect.current,data:J.data,disabled:J.disabled}:null,P={active:z,activatorEvent:$,collisions:U,delta:{x:Y.x,y:Y.y},over:xe};Ae.unstable_batchedUpdates(()=>{At(xe),X==null||X(P),R({type:"onDragOver",event:P})})},[It]),Z(()=>{G.current={activatorEvent:F,active:V,activeNode:W,collisionRect:me,collisions:Ee,droppableRects:te,draggableNodes:d,draggingNode:pe,draggingNodeRect:ve,droppableContainers:M,over:ae,scrollableAncestors:ie,scrollAdjustedTranslate:be},L.current={initial:ve,translated:me}},[V,W,Ee,me,d,pe,ve,te,M,ae,ie,be]),Lr({...oe,delta:m,draggingRect:me,pointerCoordinates:Mt,scrollableAncestors:ie,scrollableAncestorRects:He});const Cn=a.useMemo(()=>({active:V,activeNode:W,activeNodeRect:I,activatorEvent:F,collisions:Ee,containerNodeRect:je,dragOverlay:re,draggableNodes:d,droppableContainers:M,droppableRects:te,over:ae,measureDroppableContainers:ge,scrollableAncestors:ie,scrollableAncestorRects:He,measuringConfiguration:k,measuringScheduled:Ne,windowRect:ot}),[V,W,I,F,Ee,je,re,d,M,te,ae,ge,ie,He,k,Ne,ot]),Sn=a.useMemo(()=>({activatorEvent:F,activators:Lt,active:V,activeNodeRect:I,ariaDescribedById:{draggable:Re},dispatch:D,draggableNodes:d,over:ae,measureDroppableContainers:ge}),[F,Lt,V,I,D,Re,d,ae,ge]);return B.createElement(Qt.Provider,{value:w},B.createElement(st.Provider,{value:Sn},B.createElement(un.Provider,{value:Cn},B.createElement(fn.Provider,{value:wn},g)),B.createElement(rs,{disabled:(i==null?void 0:i.restoreFocus)===!1})),B.createElement(tr,{...i,hiddenTextDescribedById:Re}));function Rn(){const z=(Se==null?void 0:Se.autoScrollEnabled)===!1,$=typeof u=="object"?u.enabled===!1:u===!1,U=f&&!z&&!$;return typeof u=="object"?{...u,enabled:U}:{enabled:U}}}),ls=a.createContext(null),qt="button",cs="Draggable";function ds(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const o=$e(cs),{activators:c,activatorEvent:i,active:u,activeNodeRect:g,ariaDescribedById:h,draggableNodes:p,over:x}=a.useContext(st),{role:v=qt,roleDescription:E="draggable",tabIndex:C=0}=s??{},b=(u==null?void 0:u.id)===t,D=a.useContext(b?fn:ls),[R,w]=Qe(),[N,j]=Qe(),f=Vr(c,t),y=ze(n);Z(()=>(p.set(t,{id:t,key:o,node:R,activatorNode:N,data:y}),()=>{const m=p.get(t);m&&m.key===o&&p.delete(t)}),[p,t]);const d=a.useMemo(()=>({role:v,tabIndex:C,"aria-disabled":r,"aria-pressed":b&&v===qt?!0:void 0,"aria-roledescription":E,"aria-describedby":h.draggable}),[r,v,C,b,E,h.draggable]);return{active:u,activatorEvent:i,activeNodeRect:g,attributes:d,isDragging:b,listeners:r?void 0:f,node:R,over:x,setNodeRef:w,setActivatorNodeRef:j,transform:D}}function us(){return a.useContext(un)}const fs="Droppable",gs={timeout:25};function hs(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const o=$e(fs),{active:c,dispatch:i,over:u,measureDroppableContainers:g}=a.useContext(st),h=a.useRef({disabled:n}),p=a.useRef(!1),x=a.useRef(null),v=a.useRef(null),{disabled:E,updateMeasurementsFor:C,timeout:b}={...gs,...s},D=ze(C??r),R=a.useCallback(()=>{if(!p.current){p.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{g(Array.isArray(D.current)?D.current:[D.current]),v.current=null},b)},[b]),w=rt({callback:R,disabled:E||!c}),N=a.useCallback((d,m)=>{w&&(m&&(w.unobserve(m),p.current=!1),d&&w.observe(d))},[w]),[j,f]=Qe(N),y=ze(t);return a.useEffect(()=>{!w||!j.current||(w.disconnect(),p.current=!1,w.observe(j.current))},[j,w]),a.useEffect(()=>(i({type:A.RegisterDroppable,element:{id:r,key:o,disabled:n,node:j,rect:x,data:y}}),()=>i({type:A.UnregisterDroppable,key:o,id:r})),[r]),a.useEffect(()=>{n!==h.current.disabled&&(i({type:A.SetDroppableDisabled,id:r,key:o,disabled:n}),h.current.disabled=n)},[r,o,n,i]),{active:c,rect:x,isOver:(u==null?void 0:u.id)===r,node:j,over:u,setNodeRef:f}}function gn(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function ps(e,t){return e.reduce((n,r,s)=>{const o=t.get(r);return o&&(n[s]=o),n},Array(e.length))}function Ke(e){return e!==null&&e>=0}function vs(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function bs(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const hn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const o=gn(t,r,n),c=t[s],i=o[s];return!i||!c?null:{x:i.left-c.left,y:i.top-c.top,scaleX:i.width/c.width,scaleY:i.height/c.height}},qe={scaleX:1,scaleY:1},ms=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:o,overIndex:c}=e;const i=(t=o[n])!=null?t:r;if(!i)return null;if(s===n){const g=o[c];return g?{x:0,y:n<c?g.top+g.height-(i.top+i.height):g.top-i.top,...qe}:null}const u=xs(o,s,n);return s>n&&s<=c?{x:0,y:-i.height-u,...qe}:s<n&&s>=c?{x:0,y:i.height+u,...qe}:{x:0,y:0,...qe}};function xs(e,t,n){const r=e[t],s=e[t-1],o=e[t+1];return r?n<t?s?r.top-(s.top+s.height):o?o.top-(r.top+r.height):0:o?o.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const pn="Sortable",vn=B.createContext({activeIndex:-1,containerId:pn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:hn,disabled:{draggable:!1,droppable:!1}});function ys(e){let{children:t,id:n,items:r,strategy:s=hn,disabled:o=!1}=e;const{active:c,dragOverlay:i,droppableRects:u,over:g,measureDroppableContainers:h}=us(),p=$e(pn,n),x=i.rect!==null,v=a.useMemo(()=>r.map(f=>typeof f=="object"&&"id"in f?f.id:f),[r]),E=c!=null,C=c?v.indexOf(c.id):-1,b=g?v.indexOf(g.id):-1,D=a.useRef(v),R=!vs(v,D.current),w=b!==-1&&C===-1||R,N=bs(o);Z(()=>{R&&E&&h(v)},[R,v,E,h]),a.useEffect(()=>{D.current=v},[v]);const j=a.useMemo(()=>({activeIndex:C,containerId:p,disabled:N,disableTransforms:w,items:v,overIndex:b,useDragOverlay:x,sortedRects:ps(v,u),strategy:s}),[C,p,N.draggable,N.droppable,w,v,b,u,x,s]);return B.createElement(vn.Provider,{value:j},t)}const ws=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return gn(n,r,s).indexOf(t)},Ds=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:o,newIndex:c,previousItems:i,previousContainerId:u,transition:g}=e;return!g||!r||i!==o&&s===c?!1:n?!0:c!==s&&t===u},Cs={duration:200,easing:"ease"},bn="transform",Ss=ke.Transition.toString({property:bn,duration:0,easing:"linear"}),Rs={roleDescription:"sortable"};function Ns(e){let{disabled:t,index:n,node:r,rect:s}=e;const[o,c]=a.useState(null),i=a.useRef(n);return Z(()=>{if(!t&&n!==i.current&&r.current){const u=s.current;if(u){const g=Ce(r.current,{ignoreTransform:!0}),h={x:u.left-g.left,y:u.top-g.top,scaleX:u.width/g.width,scaleY:u.height/g.height};(h.x||h.y)&&c(h)}}n!==i.current&&(i.current=n)},[t,n,r,s]),a.useEffect(()=>{o&&c(null)},[o]),o}function js(e){let{animateLayoutChanges:t=Ds,attributes:n,disabled:r,data:s,getNewIndex:o=ws,id:c,strategy:i,resizeObserverConfig:u,transition:g=Cs}=e;const{items:h,containerId:p,activeIndex:x,disabled:v,disableTransforms:E,sortedRects:C,overIndex:b,useDragOverlay:D,strategy:R}=a.useContext(vn),w=Es(r,v),N=h.indexOf(c),j=a.useMemo(()=>({sortable:{containerId:p,index:N,items:h},...s}),[p,s,N,h]),f=a.useMemo(()=>h.slice(h.indexOf(c)),[h,c]),{rect:y,node:d,isOver:m,setNodeRef:M}=hs({id:c,data:j,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:f,...u}}),{active:S,activatorEvent:L,activeNodeRect:V,attributes:q,setNodeRef:Se,listeners:Ue,isDragging:F,over:Xe,setActivatorNodeRef:ee,transform:Re}=ds({id:c,data:j,attributes:{...Rs,...n},disabled:w.draggable}),We=Un(M,Se),k=!!S,te=k&&!E&&Ke(x)&&Ke(b),ge=!D&&F,Ne=ge&&te?Re:null,Ye=te?Ne??(i??R)({rects:C,activeNodeRect:V,activeIndex:x,overIndex:b,index:N}):null,oe=Ke(x)&&Ke(b)?o({id:c,items:h,activeIndex:x,overIndex:b}):N,ne=S==null?void 0:S.id,I=a.useRef({activeId:ne,items:h,newIndex:oe,containerId:p}),je=h!==I.current.items,G=t({active:S,containerId:p,isDragging:F,isSorting:k,id:c,index:N,items:h,newIndex:I.current.newIndex,previousItems:I.current.items,previousContainerId:I.current.containerId,transition:g,wasDragging:I.current.activeId!=null}),he=Ns({disabled:!G,index:N,node:d,rect:y});return a.useEffect(()=>{k&&I.current.newIndex!==oe&&(I.current.newIndex=oe),p!==I.current.containerId&&(I.current.containerId=p),h!==I.current.items&&(I.current.items=h)},[k,oe,p,h]),a.useEffect(()=>{if(ne===I.current.activeId)return;if(ne&&!I.current.activeId){I.current.activeId=ne;return}const pe=setTimeout(()=>{I.current.activeId=ne},50);return()=>clearTimeout(pe)},[ne]),{active:S,activeIndex:x,attributes:q,data:j,rect:y,index:N,newIndex:oe,items:h,isOver:m,isSorting:k,isDragging:F,listeners:Ue,node:d,overIndex:b,over:Xe,setNodeRef:We,setActivatorNodeRef:ee,setDroppableNodeRef:M,setDraggableNodeRef:Se,transform:he??Ye,transition:re()};function re(){if(he||je&&I.current.newIndex===N)return Ss;if(!(ge&&!Dt(L)||!g)&&(k||G))return ke.Transition.toString({...g,property:bn})}}function Es(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}T.Down,T.Right,T.Up,T.Left;const Ms=({task:e,onClick:t})=>{const{attributes:n,listeners:r,setNodeRef:s,transform:o,transition:c,isDragging:i}=js({id:e.id}),u={transform:ke.Transform.toString(o),transition:c,opacity:i?.5:1};return l.jsx("div",{ref:s,style:u,...n,...r,className:"kanban-card",children:l.jsx(Tn,{task:e,onClick:t})})},Ts=({tasks:e=[],onTaskUpdate:t,onTaskClick:n,onCreateTask:r})=>{const{canModify:s,groupId:o}=mt(),[c,i]=a.useState(!1),u=new Set(["completed","approved","submitted","reviewed","auto_approved","cancelled"]),g=new Set(["in_progress","in-progress","processing","review"]),h=new Set(["pending","waiting","scheduled","new"]),p=b=>{if(!b)return"pending";const D=b.toLowerCase();return D==="in-progress"?"in_progress":D==="waiting"||D==="scheduled"?"pending":["approved","submitted","reviewed","auto_approved","done","cancelled"].includes(D)?"completed":D},x=[{id:"pending",title:"รอดำเนินการ",icon:On,match:b=>h.has(b)},{id:"in_progress",title:"กำลังดำเนินการ",icon:Fn,match:b=>g.has(b)},{id:"overdue",title:"เกินกำหนด",icon:Nn,match:b=>b==="overdue"},{id:"completed",title:"เสร็จแล้ว",icon:Ln,match:b=>u.has(b)}],v=rr(nr(Nt,{activationConstraint:{distance:8}})),E=b=>e.filter(D=>b.match(p(D.status))),C=async b=>{const{active:D,over:R}=b;if(!R)return;if(!s()){Je("คุณไม่มีสิทธิ์แก้ไขสถานะงาน - กรุณาเข้าผ่าน LINE ส่วนตัว");return}const w=e.find(f=>f.id===D.id);if(!w)return;const N=x.find(f=>R.id===f.id||E(f).some(y=>y.id===R.id));if(!N)return;const j=p(w.status);if(!N.match(p(w.status))){let f="pending";N.id==="in_progress"&&(f="in_progress"),N.id==="overdue"&&(f="overdue"),N.id==="completed"&&(f="completed"),t&&t(w.id,{status:f}),i(!0);try{const{updateTask:y}=await jn(async()=>{const{updateTask:d}=await import("./index-CpPG0aiG.js").then(m=>m.aW);return{updateTask:d}},__vite__mapDeps([0,1]));await y(o,w.id,{status:f}),En(`อัปเดตสถานะเป็น "${N.title}" สำเร็จ`),console.log(`✅ Task ${w.id} moved from ${j} to ${f}`)}catch(y){console.error("❌ Failed to update task status:",y),Mn("ไม่สามารถอัปเดตสถานะงานได้",y),t&&t(w.id,{status:w.status})}finally{i(!1)}}};return l.jsxs("div",{className:"p-3 md:p-6 relative",children:[c&&l.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm z-50 flex items-center justify-center rounded-lg",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 flex items-center gap-3",children:[l.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),l.jsx("span",{className:"text-gray-700 font-medium",children:"กำลังอัปเดตสถานะงาน..."})]})}),l.jsx(as,{sensors:v,collisionDetection:lr,onDragEnd:C,children:l.jsx("div",{className:"kanban-board",children:x.map(b=>{const D=E(b),R=b.icon;return l.jsxs("div",{className:"kanban-column",children:[l.jsxs("div",{className:"kanban-column-header",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(R,{size:16}),l.jsx("span",{children:b.title})]}),l.jsxs("span",{className:"px-2 py-0.5 bg-white rounded-full text-xs text-gray-600",children:[D.length," งาน"]})]}),l.jsx(ys,{items:D.map(w=>w.id),strategy:ms,id:b.id,children:l.jsxs("div",{className:"space-y-2 min-h-[400px]",children:[D.map(w=>l.jsx(Ms,{task:w,onClick:()=>n&&n(w)},w.id)),l.jsx("button",{type:"button",onClick:()=>{if(!s()){Je("คุณไม่มีสิทธิ์สร้างงาน - กรุณาเข้าผ่าน LINE ส่วนตัว");return}r&&r()},disabled:!s(),className:"w-full py-2 text-sm text-blue-500 hover:text-blue-600 hover:bg-blue-50 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:s()?"สร้างงาน":"ไม่มีสิทธิ์สร้างงาน",children:"+ สร้างงาน"})]})})]},b.id)})})})]})},Bs=({tasks:e=[],onTaskUpdate:t})=>{const n=a.useMemo(()=>new Set(["completed","approved","submitted","reviewed","auto_approved"]),[]),r=a.useMemo(()=>new Set(["in_progress","in-progress","processing","review"]),[]),s=a.useMemo(()=>new Set(["pending","waiting","scheduled","new"]),[]),[o,c]=a.useState("table"),[i,u]=a.useState({status:"",priority:"",assignee:"",due:"",search:""}),{openAddTask:g,openTaskDetail:h}=In(),{canModify:p}=mt(),x=p(),v=()=>{if(!x){Je("โหมดดูอย่างเดียว - กรุณาเข้าผ่าน LINE ส่วนตัวเพื่อสร้างงาน");return}g("normal")},E=f=>{f&&h(f)},C=a.useMemo(()=>{const f=new Set;return e.forEach(y=>{Array.isArray(y.assignedUsers)&&y.assignedUsers.forEach(d=>f.add(d.displayName||d.name||d.lineUserId)),y.assignee&&f.add(y.assignee.name||y.assignee.displayName||y.assignee.lineUserId)}),Array.from(f)},[e]),b=f=>f.dueDate?new Date(f.dueDate):f.dueTime?new Date(f.dueTime):f.scheduledDate?new Date(f.scheduledDate):f.startTime?new Date(f.startTime):null,D=a.useMemo(()=>{const f=new Date;return f.setHours(0,0,0,0),f},[]),R=a.useMemo(()=>{const f=new Date;return f.setHours(23,59,59,999),f},[]),w=a.useMemo(()=>e.filter(f=>{if(!(!i.search||(f.title||"").toLowerCase().includes(i.search.toLowerCase())||(f.description||"").toLowerCase().includes(i.search.toLowerCase())))return!1;if(i.status){const d=f.status;if(i.status==="pending"&&!s.has(d)||i.status==="in_progress"&&!r.has(d)||i.status==="completed"&&!n.has(d))return!1;if(i.status==="overdue"){const m=b(f);if(!(d==="overdue")&&(!m||m>=D||n.has(d)))return!1}}if(i.priority&&(f.priority||"").toLowerCase()!==i.priority)return!1;if(i.assignee){const d=new Set;if(Array.isArray(f.assignedUsers)&&f.assignedUsers.forEach(m=>d.add(m.displayName||m.name||m.lineUserId)),f.assignee&&d.add(f.assignee.name||f.assignee.displayName||f.assignee.lineUserId),!d.has(i.assignee))return!1}if(i.due){const d=b(f);if(d){const m=d.getTime(),M=D.getTime();if(i.due==="today"){if(!(d>=D&&d<=R))return!1}else if(i.due==="tomorrow"){const S=new Date(D);S.setDate(S.getDate()+1);const L=new Date(S);if(L.setHours(23,59,59,999),!(d>=S&&d<=L))return!1}else if(i.due==="week"){const S=new Date(D);if(S.setDate(S.getDate()+7),!(d>=D&&d<=S))return!1}else if(i.due==="overdue"&&(m>=M||n.has(f.status)))return!1}else if(i.due!=="unscheduled")return!1}return!0}),[e,i,D,R]),N=()=>{u({status:"",priority:"",assignee:"",due:"",search:""})},j=a.useMemo(()=>{const f=w.length,y=w.filter(S=>s.has(S.status)).length,d=w.filter(S=>r.has(S.status)).length,m=w.filter(S=>n.has(S.status)).length,M=w.filter(S=>{if(S.status==="overdue")return!0;const L=b(S);return L&&L<D&&!n.has(S.status)}).length;return{total:f,pending:y,inProgress:d,completed:m,overdue:M}},[w,D,n,r,s]);return l.jsxs("div",{children:[l.jsx("div",{className:"px-3 md:px-6 py-3 md:py-4 bg-white border-b border-border",children:l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 md:gap-4 w-full sm:w-auto",children:[l.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"จัดการงานทั้งหมด"}),l.jsxs("button",{type:"button",onClick:v,disabled:!x,className:An("btn-bordio flex items-center gap-2",!x&&"cursor-not-allowed bg-gray-200 text-gray-500 hover:bg-gray-200 dark:bg-gray-300 dark:text-gray-600"),title:x?"สร้างงานใหม่":"โหมดดูอย่างเดียว - ต้องมี userId ถึงจะสร้างงานได้",children:[l.jsx(Pn,{size:16}),"เพิ่มงาน"]}),!x&&l.jsx("span",{className:"text-xs text-red-500 font-medium",children:'🔒 เข้าผ่าน LINE ส่วนตัว หรือพิมพ์ "เพิ่มงาน" เพื่อสร้างงานได้'})]}),l.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[l.jsxs("button",{onClick:()=>c("table"),className:`flex-1 sm:flex-none px-3 md:px-4 py-2 rounded-md text-xs md:text-sm font-medium flex items-center justify-center gap-1 md:gap-2 transition-colors ${o==="table"?"bg-blue-500 text-white":"bg-white border border-border text-gray-700 hover:bg-gray-50"}`,children:[l.jsx(_n,{size:16}),l.jsx("span",{className:"hidden sm:inline",children:"มุมมองตาราง"}),l.jsx("span",{className:"sm:hidden",children:"ตาราง"})]}),l.jsxs("button",{onClick:()=>c("kanban"),className:`flex-1 sm:flex-none px-3 md:px-4 py-2 rounded-md text-xs md:text-sm font-medium flex items-center justify-center gap-1 md:gap-2 transition-colors ${o==="kanban"?"bg-blue-500 text-white":"bg-white border border-border text-gray-700 hover:bg-gray-50"}`,children:[l.jsx(zn,{size:16}),l.jsx("span",{className:"hidden sm:inline",children:"กระดานคัมบัน"}),l.jsx("span",{className:"sm:hidden",children:"คัมบัน"})]})]})]})}),l.jsxs("div",{className:"px-3 md:px-6 py-3 md:py-4 border-b border-border bg-white",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3 md:mb-4 text-xs md:text-sm font-semibold text-gray-600",children:[l.jsx(kn,{className:"w-4 h-4"}),"ตัวกรองงาน"]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2",children:"สถานะ"}),l.jsxs("select",{className:"w-full border border-border rounded-md px-3 py-2 text-sm",value:i.status,onChange:f=>u(y=>({...y,status:f.target.value})),children:[l.jsx("option",{value:"",children:"ทั้งหมด"}),l.jsx("option",{value:"pending",children:"รอดำเนินการ"}),l.jsx("option",{value:"in_progress",children:"กำลังดำเนินการ"}),l.jsx("option",{value:"completed",children:"เสร็จแล้ว"}),l.jsx("option",{value:"overdue",children:"เกินกำหนด"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2",children:"ความสำคัญ"}),l.jsxs("select",{className:"w-full border border-border rounded-md px-3 py-2 text-sm",value:i.priority,onChange:f=>u(y=>({...y,priority:f.target.value})),children:[l.jsx("option",{value:"",children:"ทั้งหมด"}),l.jsx("option",{value:"low",children:"ต่ำ"}),l.jsx("option",{value:"medium",children:"ปานกลาง"}),l.jsx("option",{value:"high",children:"สูง"}),l.jsx("option",{value:"urgent",children:"เร่งด่วน"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2",children:"ผู้รับผิดชอบ"}),l.jsxs("select",{className:"w-full border border-border rounded-md px-3 py-2 text-sm",value:i.assignee,onChange:f=>u(y=>({...y,assignee:f.target.value})),children:[l.jsx("option",{value:"",children:"ทั้งหมด"}),C.map(f=>l.jsx("option",{value:f,children:f},f))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2",children:"กำหนดส่ง"}),l.jsxs("select",{className:"w-full border border-border rounded-md px-3 py-2 text-sm",value:i.due,onChange:f=>u(y=>({...y,due:f.target.value})),children:[l.jsx("option",{value:"",children:"ทั้งหมด"}),l.jsx("option",{value:"today",children:"วันนี้"}),l.jsx("option",{value:"tomorrow",children:"พรุ่งนี้"}),l.jsx("option",{value:"week",children:"7 วันข้างหน้า"}),l.jsx("option",{value:"overdue",children:"เกินกำหนด"}),l.jsx("option",{value:"unscheduled",children:"ยังไม่กำหนด"})]})]})]}),l.jsxs("div",{className:"flex flex-col md:flex-row gap-3 mt-4",children:[l.jsx("input",{type:"text",placeholder:"ค้นหาชื่องานหรือรายละเอียด...",className:"flex-1 border border-border rounded-md px-3 py-2 text-sm",value:i.search,onChange:f=>u(y=>({...y,search:f.target.value}))}),l.jsxs("button",{type:"button",onClick:N,className:"inline-flex items-center justify-center gap-2 px-4 py-2 border border-border rounded-md text-sm hover:bg-gray-50 transition",children:[l.jsx(Bn,{className:"w-4 h-4"}),"รีเซ็ตตัวกรอง"]})]})]}),l.jsx("div",{className:"px-3 md:px-6 py-3 md:py-4 bg-white border-b border-border",children:l.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[l.jsxs("div",{className:"rounded-lg border border-blue-100 bg-blue-50 p-2 md:p-4",children:[l.jsx("p",{className:"text-xs text-blue-700",children:"งานที่แสดง"}),l.jsx("p",{className:"text-xl md:text-2xl font-semibold text-blue-700",children:j.total})]}),l.jsxs("div",{className:"rounded-lg border border-amber-100 bg-amber-50 p-2 md:p-4",children:[l.jsx("p",{className:"text-xs text-amber-700",children:"รอดำเนินการ"}),l.jsx("p",{className:"text-xl md:text-2xl font-semibold text-amber-700",children:j.pending+j.inProgress})]}),l.jsxs("div",{className:"rounded-lg border border-green-100 bg-green-50 p-2 md:p-4",children:[l.jsx("p",{className:"text-xs text-green-700",children:"เสร็จแล้ว"}),l.jsx("p",{className:"text-xl md:text-2xl font-semibold text-green-700",children:j.completed})]}),l.jsxs("div",{className:"rounded-lg border border-red-100 bg-red-50 p-2 md:p-4",children:[l.jsx("p",{className:"text-xs text-red-700",children:"เกินกำหนด"}),l.jsx("p",{className:"text-xl md:text-2xl font-semibold text-red-700",children:j.overdue})]})]})}),o==="table"?l.jsx($n,{tasks:w,onTaskUpdate:t,onTaskClick:E,onCreateTask:v}):l.jsx(Ts,{tasks:w,onTaskUpdate:t,onTaskClick:E,onCreateTask:v})]})};export{Bs as default};
