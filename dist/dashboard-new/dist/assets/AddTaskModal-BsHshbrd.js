const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CkUAMYdr.js","assets/index-qXZDfFvN.css"])))=>i.map(i=>d[i]);
import{r as i,j as e,B as j,e as ge,u as ye,_ as se,s as $,h as fe,i as ve,x as re,C as ae}from"./index-CkUAMYdr.js";import{D as Ne,a as be,b as ke,c as we,d as Ce}from"./dialog-DPTiGGGx.js";import{T as De,a as Te,b as te,c as le}from"./tabs-BgLNq8av.js";import{I as U}from"./input-DKGNKTR-.js";import{L as d}from"./label-BJe2V66q.js";import{T as ne}from"./textarea-qDOkATwC.js";import{S as v,a as N,b,c as k,d as t}from"./select-DPXkz_pv.js";import{C as ie}from"./checkbox-BTZseQt4.js";import{P as ce,a as de,b as oe,C as ue}from"./popover-BBd8w3DV.js";import{S as xe}from"./search-cCVafR11.js";import{f as B}from"./format-DqSJChTQ.js";import{t as he}from"./th-Mr45T5HM.js";import"./index-CGJYNE2k.js";import"./index-BuCVsLOD.js";import"./chevron-down-CyNZVHST.js";import"./check-Eaa5JV2K.js";import"./endOfMonth-B7YxEMnH.js";import"./chevron-right-_VcdZaD6.js";const Se=({value:u,onChange:y})=>{const[o,C]=i.useState((u==null?void 0:u.type)||"daily"),[x,F]=i.useState((u==null?void 0:u.interval)||1),[c,M]=i.useState((u==null?void 0:u.daysOfWeek)||[]),[p,I]=i.useState((u==null?void 0:u.dayOfMonth)||1);i.useEffect(()=>{y({type:o,interval:x,daysOfWeek:o==="weekly"?c:[],dayOfMonth:o==="monthly"?p:null})},[o,x,c,p,y]);const E=r=>{C(r),r!=="weekly"&&M([]),r!=="monthly"&&I(1)},D=r=>{const l=parseInt(r.target.value)||1;F(Math.max(1,l))},V=r=>{c.includes(r)?M(c.filter(l=>l!==r)):M([...c,r].sort())},T=r=>{I(parseInt(r))},a=()=>{if(o==="daily")return x===1?"ทุกวัน":`ทุก ${x} วัน`;if(o==="weekly"){const r=["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์"],l=c.map(g=>r[g]).join(", ");return c.length===0?`ทุก ${x} สัปดาห์ (ยังไม่ได้เลือกวัน)`:x===1?`ทุกสัปดาห์ในวัน ${l}`:`ทุก ${x} สัปดาห์ ในวัน ${l}`}return o==="monthly"?x===1?`ทุกเดือน วันที่ ${p}`:`ทุก ${x} เดือน วันที่ ${p}`:""},h=()=>o==="daily"?"วัน":o==="weekly"?"สัปดาห์":o==="monthly"?"เดือน":"";return e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("h4",{className:"font-medium text-sm",children:"ตั้งค่าความถี่แบบกำหนดเอง"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"recurrence-type",children:"ประเภท"}),e.jsxs(v,{value:o,onValueChange:E,children:[e.jsx(N,{id:"recurrence-type",children:e.jsx(b,{})}),e.jsxs(k,{children:[e.jsx(t,{value:"daily",children:"รายวัน"}),e.jsx(t,{value:"weekly",children:"รายสัปดาห์"}),e.jsx(t,{value:"monthly",children:"รายเดือน"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"recurrence-interval",children:"ทุก"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{id:"recurrence-interval",type:"number",min:"1",max:"365",value:x,onChange:D,className:"w-20"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:h()})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"ตัวเลขต้องมากกว่า 0"})]}),o==="weekly"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"วันที่ทำ"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"อา",index:0},{label:"จ",index:1},{label:"อ",index:2},{label:"พ",index:3},{label:"พฤ",index:4},{label:"ศ",index:5},{label:"ส",index:6}].map(({label:r,index:l})=>e.jsx(j,{type:"button",variant:c.includes(l)?"default":"outline",size:"sm",className:"w-12 h-10 p-0",onClick:()=>V(l),children:r},l))}),c.length===0&&e.jsx("p",{className:"text-sm text-red-500",children:"⚠️ กรุณาเลือกอย่างน้อย 1 วัน"}),c.length>0&&e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400",children:["✓ เลือก ",c.length," วัน"]})]}),o==="monthly"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"day-of-month",children:"วันที่ของเดือน"}),e.jsxs(v,{value:p.toString(),onValueChange:T,children:[e.jsx(N,{id:"day-of-month",children:e.jsx(b,{})}),e.jsx(k,{className:"max-h-60",children:Array.from({length:31},(r,l)=>l+1).map(r=>e.jsxs(t,{value:r.toString(),children:["วันที่ ",r]},r))})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"เดือนที่มีวันน้อยกว่าจะใช้วันสุดท้ายของเดือน"})]}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100 mb-1",children:"ตัวอย่าง"}),e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:a()})]})]})}),o==="weekly"&&c.length===0&&e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-950 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"text-yellow-600 dark:text-yellow-400 mt-0.5",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("p",{className:"text-xs text-yellow-800 dark:text-yellow-200",children:"ต้องเลือกอย่างน้อย 1 วันสำหรับงานประจำรายสัปดาห์"})]})})]})};function Qe({onTaskCreated:u}){const{groupId:y,userId:o}=ge(),{isAddTaskOpen:C,closeAddTask:x,addTaskDefaultTab:F}=ye(),[c,M]=i.useState("normal"),[p,I]=i.useState(!1),[E,D]=i.useState(!1),[V,T]=i.useState(!1),[a,h]=i.useState({title:"",description:"",dueDate:null,dueTime:"",priority:"medium",category:"general",assignedUsers:[],reviewer:""}),[r,l]=i.useState({title:"",description:"",recurrence:"weekly",startDate:null,time:"",priority:"medium",category:"general",assignedUsers:[],reviewer:"",customRecurrence:{type:"weekly",interval:1,daysOfWeek:[],dayOfMonth:1}}),[g,G]=i.useState([]),[Q,H]=i.useState(!1),[R,J]=i.useState(null),[S,W]=i.useState("");i.useEffect(()=>{C&&M(F||"normal")},[C,F]),i.useEffect(()=>{D(!1),T(!1)},[c]);const L=i.useCallback(async()=>{if(y){H(!0),J(null);try{const{getGroupMembers:s}=await se(async()=>{const{getGroupMembers:w}=await import("./index-CkUAMYdr.js").then(O=>O.aC);return{getGroupMembers:w}},__vite__mapDeps([0,1])),n=await s(y),m=n.members||n||[];G(Array.isArray(m)?m:[])}catch(s){console.error("Failed to load members:",s),J(s.message||"ไม่สามารถโหลดรายชื่อสมาชิกได้"),G([])}finally{H(!1)}}},[y]);i.useEffect(()=>{C&&L()},[C,L]);const A=i.useMemo(()=>{if(!S.trim())return g;const s=S.toLowerCase();return g.filter(n=>(n.displayName||n.name||"").toLowerCase().includes(s))},[g,S]),K=i.useCallback(()=>{h({title:"",description:"",dueDate:null,dueTime:"",priority:"medium",category:"general",assignedUsers:[],reviewer:""}),l({title:"",description:"",recurrence:"weekly",startDate:null,time:"",priority:"medium",category:"general",assignedUsers:[],reviewer:"",customRecurrence:{type:"weekly",interval:1,daysOfWeek:[],dayOfMonth:1}}),D(!1),T(!1),W("")},[]),z=i.useCallback(s=>{if(!s)return null;try{return B(s,"yyyy-MM-dd")}catch(n){return console.warn("Failed to format date",n),null}},[]),X=i.useCallback(async s=>{var m,w,O;s.preventDefault();const n=c==="normal"?a:r;if(!((m=n.title)!=null&&m.trim())){$("กรุณาระบุชื่องาน");return}if(n.assignedUsers.length===0){$("กรุณาเลือกผู้รับผิดชอบอย่างน้อย 1 คน");return}if(c==="normal"&&!a.dueDate){$("กรุณาเลือกวันที่ครบกำหนด");return}if(c==="recurring"&&!r.startDate){$("กรุณาเลือกวันที่เริ่มต้น");return}I(!0);try{const{createTask:f,createRecurringTask:je}=await se(async()=>{const{createTask:_,createRecurringTask:P}=await import("./index-CkUAMYdr.js").then(q=>q.aC);return{createTask:_,createRecurringTask:P}},__vite__mapDeps([0,1]));if(c==="normal"){const _=z(a.dueDate),P=a.dueTime||"23:59",q=`${_}T${P}:00.000+07:00`,pe={title:a.title,description:a.description||"",dueTime:q,priority:a.priority,category:a.category,assigneeIds:[...new Set(a.assignedUsers)],reviewerUserId:a.reviewer||null,requireAttachment:!1,createdBy:o};await f(y,pe)}else{const _={...r,startDate:z(r.startDate),time:r.time||null,reviewer:r.reviewer||null,assignedUsers:[...new Set(r.assignedUsers)],customRecurrence:{...r.customRecurrence,daysOfWeek:((O=(w=r.customRecurrence)==null?void 0:w.daysOfWeek)==null?void 0:O.slice())||[]}};await je(y,_)}fe(c==="normal"?"สร้างงานสำเร็จ":"สร้างงานประจำสำเร็จ"),u&&u(),x(),K()}catch(f){console.error("Failed to create task:",f),ve((f==null?void 0:f.message)||"ไม่สามารถสร้างงานได้",f)}finally{I(!1)}},[c,a,r,y,o,u,x,K,z]),Y=(s,n=!0)=>{const m=n?a:r,w=n?h:l,O=m.assignedUsers.includes(s)?m.assignedUsers.filter(f=>f!==s):[...m.assignedUsers,s];w({...m,assignedUsers:O})},Z=(s=!0)=>{(s?h:l)({...s?a:r,assignedUsers:g.map(w=>w.lineUserId)})},ee=(s=!0)=>{(s?h:l)({...s?a:r,assignedUsers:[]})},me=s=>{s||(x(),D(!1),T(!1))};return e.jsx(Ne,{open:C,onOpenChange:me,children:e.jsxs(be,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ke,{children:[e.jsx(we,{children:"เพิ่มงานใหม่"}),e.jsx(Ce,{children:"สร้างงานใหม่หรืองานประจำ"})]}),e.jsxs(De,{value:c,onValueChange:M,children:[e.jsxs(Te,{className:"grid w-full grid-cols-2",children:[e.jsx(te,{value:"normal",children:"📄 งานทั่วไป"}),e.jsx(te,{value:"recurring",children:"🔄 งานประจำ"})]}),e.jsx(le,{value:"normal",children:e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"title",children:"ชื่องาน *"}),e.jsx(U,{id:"title",value:a.title,onChange:s=>h({...a,title:s.target.value}),placeholder:"ระบุชื่องาน",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"description",children:"รายละเอียด"}),e.jsx(ne,{id:"description",value:a.description,onChange:s=>h({...a,description:s.target.value}),placeholder:"ระบุรายละเอียด",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{className:"flex items-center gap-1",children:["วันที่ครบกำหนด ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(ce,{modal:!1,open:E,onOpenChange:D,children:[e.jsx(de,{asChild:!0,children:e.jsxs(j,{type:"button",variant:"outline",className:re("w-full justify-start text-left font-normal h-10 hover:bg-accent transition-colors",!a.dueDate&&"text-muted-foreground"),children:[e.jsx(ae,{className:"mr-2 h-4 w-4 text-primary"}),a.dueDate?B(a.dueDate,"d MMMM yyyy",{locale:he}):"เลือกวันที่"]})}),e.jsx(oe,{align:"start",sideOffset:12,side:"bottom",className:"w-auto p-0 shadow-xl border-2",children:e.jsx(ue,{mode:"single",selected:a.dueDate,onSelect:s=>{if(!s){h(n=>({...n,dueDate:null}));return}h(n=>({...n,dueDate:s})),D(!1)},initialFocus:!0,fromDate:new Date})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"dueTime",className:"flex items-center gap-1",children:["เวลา"," ",e.jsx("span",{className:"text-muted-foreground text-xs",children:"(เริ่มต้น 23:59)"})]}),e.jsx(U,{id:"dueTime",type:"time",value:a.dueTime,onChange:s=>h({...a,dueTime:s.target.value}),className:"h-10"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"ความสำคัญ"}),e.jsxs(v,{value:a.priority,onValueChange:s=>h({...a,priority:s}),children:[e.jsx(N,{children:e.jsx(b,{})}),e.jsxs(k,{children:[e.jsx(t,{value:"low",children:"ต่ำ"}),e.jsx(t,{value:"medium",children:"ปานกลาง"}),e.jsx(t,{value:"high",children:"สูง"}),e.jsx(t,{value:"urgent",children:"ด่วน"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"หมวดหมู่"}),e.jsxs(v,{value:a.category,onValueChange:s=>h({...a,category:s}),children:[e.jsx(N,{children:e.jsx(b,{})}),e.jsxs(k,{children:[e.jsx(t,{value:"general",children:"ทั่วไป"}),e.jsx(t,{value:"meeting",children:"การประชุม"}),e.jsx(t,{value:"report",children:"รายงาน"}),e.jsx(t,{value:"project",children:"โครงการ"}),e.jsx(t,{value:"maintenance",children:"บำรุงรักษา"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"ผู้รับผิดชอบ *"}),e.jsx("div",{className:"border rounded-lg p-4 space-y-3",children:Q?e.jsx("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),e.jsx("span",{className:"text-sm",children:"กำลังโหลดรายชื่อสมาชิก..."})]})}):R?e.jsxs("div",{className:"py-4 text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-destructive",children:R}),e.jsx(j,{type:"button",variant:"outline",size:"sm",onClick:L,children:"ลองอีกครั้ง"})]}):g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"ไม่พบสมาชิกในกลุ่ม"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(U,{type:"text",placeholder:"ค้นหาชื่อสมาชิก...",value:S,onChange:s=>W(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-2",children:A.length===0?e.jsxs("p",{className:"text-sm text-muted-foreground text-center py-4",children:['ไม่พบสมาชิกที่ชื่อ "',S,'"']}):A.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{id:`assignee-${s.lineUserId}`,checked:a.assignedUsers.includes(s.lineUserId),onCheckedChange:()=>Y(s.lineUserId,!0)}),e.jsx("label",{htmlFor:`assignee-${s.lineUserId}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:s.displayName||s.name})]},s.lineUserId))}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsx(j,{type:"button",variant:"outline",size:"sm",onClick:()=>Z(!0),children:"เลือกทั้งหมด"}),e.jsx(j,{type:"button",variant:"outline",size:"sm",onClick:()=>ee(!0),children:"ล้างทั้งหมด"})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"ผู้ตรวจงาน"}),e.jsxs(v,{value:a.reviewer||"__none",onValueChange:s=>h({...a,reviewer:s==="__none"?"":s}),children:[e.jsx(N,{children:e.jsx(b,{placeholder:"(ไม่ระบุ)"})}),e.jsxs(k,{children:[e.jsx(t,{value:"__none",children:"(ไม่ระบุ)"}),g.map(s=>e.jsx(t,{value:s.lineUserId,children:s.displayName||s.name},s.lineUserId))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(j,{type:"button",variant:"outline",onClick:x,children:"ยกเลิก"}),e.jsx(j,{type:"submit",disabled:p,children:p?"กำลังสร้าง...":"สร้างงาน"})]})]})}),e.jsx(le,{value:"recurring",children:e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"recurring-title",children:"ชื่องาน *"}),e.jsx(U,{id:"recurring-title",value:r.title,onChange:s=>l({...r,title:s.target.value}),placeholder:"ระบุชื่องาน",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"recurring-description",children:"รายละเอียด"}),e.jsx(ne,{id:"recurring-description",value:r.description,onChange:s=>l({...r,description:s.target.value}),placeholder:"ระบุรายละเอียด",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"รอบการทำซ้ำ *"}),e.jsxs(v,{value:r.recurrence,onValueChange:s=>l({...r,recurrence:s}),children:[e.jsx(N,{children:e.jsx(b,{})}),e.jsxs(k,{children:[e.jsx(t,{value:"daily",children:"รายวัน"}),e.jsx(t,{value:"weekly",children:"รายสัปดาห์"}),e.jsx(t,{value:"monthly",children:"รายเดือน"}),e.jsx(t,{value:"quarterly",children:"รายไตรมาส"}),e.jsx(t,{value:"custom",children:"กำหนดเอง"})]})]})]}),r.recurrence==="custom"&&e.jsx(Se,{value:r.customRecurrence,onChange:s=>l({...r,customRecurrence:s})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{className:"flex items-center gap-1",children:["วันที่เริ่ม ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(ce,{modal:!1,open:V,onOpenChange:T,children:[e.jsx(de,{asChild:!0,children:e.jsxs(j,{type:"button",variant:"outline",className:re("w-full justify-start text-left font-normal h-10 hover:bg-accent transition-colors",!r.startDate&&"text-muted-foreground"),children:[e.jsx(ae,{className:"mr-2 h-4 w-4 text-primary"}),r.startDate?B(r.startDate,"d MMMM yyyy",{locale:he}):"เลือกวันที่"]})}),e.jsx(oe,{align:"start",sideOffset:12,side:"bottom",className:"w-auto p-0 shadow-xl border-2",children:e.jsx(ue,{mode:"single",selected:r.startDate,onSelect:s=>{if(!s){l(n=>({...n,startDate:null}));return}l(n=>({...n,startDate:s})),T(!1)},initialFocus:!0,fromDate:new Date})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"recurring-time",className:"flex items-center gap-1",children:["เวลา"," ",e.jsx("span",{className:"text-muted-foreground text-xs",children:"(เริ่มต้น 09:00)"})]}),e.jsx(U,{id:"recurring-time",type:"time",value:r.time,onChange:s=>l({...r,time:s.target.value}),className:"h-10"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"ความสำคัญ"}),e.jsxs(v,{value:r.priority,onValueChange:s=>l({...r,priority:s}),children:[e.jsx(N,{children:e.jsx(b,{})}),e.jsxs(k,{children:[e.jsx(t,{value:"low",children:"ต่ำ"}),e.jsx(t,{value:"medium",children:"ปานกลาง"}),e.jsx(t,{value:"high",children:"สูง"}),e.jsx(t,{value:"urgent",children:"ด่วน"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"หมวดหมู่"}),e.jsxs(v,{value:r.category,onValueChange:s=>l({...r,category:s}),children:[e.jsx(N,{children:e.jsx(b,{})}),e.jsxs(k,{children:[e.jsx(t,{value:"general",children:"ทั่วไป"}),e.jsx(t,{value:"meeting",children:"การประชุม"}),e.jsx(t,{value:"report",children:"รายงาน"}),e.jsx(t,{value:"project",children:"โครงการ"}),e.jsx(t,{value:"maintenance",children:"บำรุงรักษา"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"ผู้รับผิดชอบ *"}),e.jsx("div",{className:"border rounded-lg p-4 space-y-3",children:Q?e.jsx("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),e.jsx("span",{className:"text-sm",children:"กำลังโหลดรายชื่อสมาชิก..."})]})}):R?e.jsxs("div",{className:"py-4 text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-destructive",children:R}),e.jsx(j,{type:"button",variant:"outline",size:"sm",onClick:L,children:"ลองอีกครั้ง"})]}):g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"ไม่พบสมาชิกในกลุ่ม"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(U,{type:"text",placeholder:"ค้นหาชื่อสมาชิก...",value:S,onChange:s=>W(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-2",children:A.length===0?e.jsxs("p",{className:"text-sm text-muted-foreground text-center py-4",children:['ไม่พบสมาชิกที่ชื่อ "',S,'"']}):A.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{id:`recurring-assignee-${s.lineUserId}`,checked:r.assignedUsers.includes(s.lineUserId),onCheckedChange:()=>Y(s.lineUserId,!1)}),e.jsx("label",{htmlFor:`recurring-assignee-${s.lineUserId}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:s.displayName||s.name})]},s.lineUserId))}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsx(j,{type:"button",variant:"outline",size:"sm",onClick:()=>Z(!1),children:"เลือกทั้งหมด"}),e.jsx(j,{type:"button",variant:"outline",size:"sm",onClick:()=>ee(!1),children:"ล้างทั้งหมด"})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"ผู้ตรวจงาน"}),e.jsxs(v,{value:r.reviewer||"__none",onValueChange:s=>l({...r,reviewer:s==="__none"?"":s}),children:[e.jsx(N,{children:e.jsx(b,{placeholder:"(ไม่ระบุ)"})}),e.jsxs(k,{children:[e.jsx(t,{value:"__none",children:"(ไม่ระบุ)"}),g.map(s=>e.jsx(t,{value:s.lineUserId,children:s.displayName||s.name},s.lineUserId))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(j,{type:"button",variant:"outline",onClick:x,children:"ยกเลิก"}),e.jsx(j,{type:"submit",disabled:p,children:p?"กำลังสร้าง...":"สร้างงานประจำ"})]})]})})]})]})})}export{Qe as default};
