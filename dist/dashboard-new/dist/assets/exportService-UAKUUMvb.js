async function u(e,n,o){switch(o){case"pdf":return p(e);case"excel":return d(e);case"csv":return f(e);default:throw new Error(`Unsupported format: ${o}`)}}function p(e,n){console.log("Exporting to PDF...",e);const o=new Blob(["PDF content"],{type:"application/pdf"});r(o,"report.pdf")}function d(e,n){console.log("Exporting to Excel...",e);const o=new Blob(["Excel content"],{type:"application/vnd.ms-excel"});r(o,"report.xlsx")}function f(e,n){const{byMember:o}=e,t=["ชื่อ","งานที่ได้รับ","งานที่เสร็จ","อัตราความสำเร็จ"],l=o.map(c=>[c.name,c.assigned,c.completed,`${c.rate}%`]),a=[t.join(","),...l.map(c=>c.join(","))].join(`
`),i=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"});r(i,"report.csv")}function r(e,n){const o=URL.createObjectURL(e),t=document.createElement("a");t.href=o,t.download=n,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(o)}async function b(e,n,o="csv"){if(o==="csv"){const t=["รายการ","จำนวน"],l=[["งานทั้งหมด",n.totalTasks||0],["งานที่เสร็จแล้ว",n.completedTasks||0],["งานที่กำลังดำเนินการ",n.inProgressTasks||0],["งานที่เกินกำหนด",n.overdueTasks||0],["งานใหม่",n.newTasks||0]],a=[t.join(","),...l.map(s=>s.join(",")),"","--- รายละเอียดงาน ---","ชื่องาน,สถานะ,วันครบกำหนด",...e.map(s=>[`"${(s.title||"").replace(/"/g,'""')}"`,s.status||"-",s.dueDate||s.deadline||"-"].join(","))].join(`
`),i=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),c=new Date().toISOString().slice(0,10);r(i,`dashboard_${c}.csv`)}}export{b as exportDashboardData,u as exportReport};
