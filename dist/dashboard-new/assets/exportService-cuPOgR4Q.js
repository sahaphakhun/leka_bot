const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BqkKSn_R.js","assets/index-B8PbDF4y.css"])))=>i.map(i=>d[i]);
import{_ as d}from"./index-BqkKSn_R.js";async function j(e,n,o){try{const s=typeof localStorage<"u"?localStorage.getItem("leka_groupId"):null;if(s&&(o==="pdf"||o==="excel")){const{exportReports:r}=await d(async()=>{const{exportReports:c}=await import("./index-BqkKSn_R.js").then(t=>t.aX);return{exportReports:c}},__vite__mapDeps([0,1])),l=await r(s,{...n,format:o}),a=document.createElement("a");a.href=l,a.download=`report_${Date.now()}.${o==="pdf"?"pdf":"xlsx"}`,document.body.appendChild(a),a.click(),document.body.removeChild(a);return}}catch(s){console.warn("Backend export failed, falling back to client-side:",s)}switch(o){case"pdf":return u(e);case"excel":return f(e);case"csv":return x(e);default:throw new Error(`Unsupported format: ${o}`)}}function u(e,n){console.log("Exporting to PDF...",e);const o=new Blob(["PDF content"],{type:"application/pdf"});i(o,"report.pdf")}function f(e,n){console.log("Exporting to Excel...",e);const o=new Blob(["Excel content"],{type:"application/vnd.ms-excel"});i(o,"report.xlsx")}function x(e,n){const{byMember:o}=e,s=["ชื่อ","งานที่ได้รับ","งานที่เสร็จ","อัตราความสำเร็จ"],r=o.map(c=>[c.name,c.assigned,c.completed,`${c.rate}%`]),l=[s.join(","),...r.map(c=>c.join(","))].join(`
`),a=new Blob(["\uFEFF"+l],{type:"text/csv;charset=utf-8;"});i(a,"report.csv")}function i(e,n){const o=URL.createObjectURL(e),s=document.createElement("a");s.href=o,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o)}async function g(e,n="csv"){switch(n){case"csv":return w(e);case"excel":return v(e);case"json":return b(e);default:throw new Error(`Unsupported format: ${n}`)}}function w(e){const n=["ชื่อผู้ใช้","LINE User ID","บทบาท","สถานะ","วันที่เข้าร่วม","งานที่เสร็จ","งานทั้งหมด"],o={admin:"ผู้ดูแล",moderator:"ผู้ควบคุม",member:"สมาชิก"},s={active:"ใช้งานอยู่",inactive:"ไม่ใช้งาน",banned:"ถูกระงับ"},r=e.map(t=>[`"${(t.displayName||t.name||"ไม่ระบุ").replace(/"/g,'""')}"`,t.lineUserId||"-",o[t.role]||t.role||"สมาชิก",s[t.status]||t.status||"ใช้งานอยู่",t.joinedAt?new Date(t.joinedAt).toLocaleDateString("th-TH"):"-",t.completedTasks||0,t.totalTasks||0]),l=[n.join(","),...r.map(t=>t.join(","))].join(`
`),a=new Blob(["\uFEFF"+l],{type:"text/csv;charset=utf-8;"}),c=new Date().toISOString().slice(0,10);i(a,`members_${c}.csv`)}function v(e){const n=["ชื่อผู้ใช้","LINE User ID","บทบาท","สถานะ","วันที่เข้าร่วม","งานที่เสร็จ","งานทั้งหมด"],o={admin:"ผู้ดูแล",moderator:"ผู้ควบคุม",member:"สมาชิก"},s={active:"ใช้งานอยู่",inactive:"ไม่ใช้งาน",banned:"ถูกระงับ"},r=e.map(t=>[(t.displayName||t.name||"ไม่ระบุ").replace(/"/g,'""'),t.lineUserId||"-",o[t.role]||t.role||"สมาชิก",s[t.status]||t.status||"ใช้งานอยู่",t.joinedAt?new Date(t.joinedAt).toLocaleDateString("th-TH"):"-",t.completedTasks||0,t.totalTasks||0]),l=[n.join(","),...r.map(t=>t.map(p=>`"${p}"`).join(","))].join(`
`),a=new Blob(["\uFEFF"+l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),c=new Date().toISOString().slice(0,10);i(a,`members_${c}.xlsx`)}function b(e){const n=JSON.stringify(e,null,2),o=new Blob([n],{type:"application/json;charset=utf-8;"}),s=new Date().toISOString().slice(0,10);i(o,`members_${s}.json`)}async function y(e,n,o="csv"){if(o==="csv"){const s=["รายการ","จำนวน"],r=[["งานทั้งหมด",n.totalTasks||0],["งานที่เสร็จแล้ว",n.completedTasks||0],["งานที่กำลังดำเนินการ",n.inProgressTasks||0],["งานที่เกินกำหนด",n.overdueTasks||0],["งานใหม่",n.newTasks||0]],l=[s.join(","),...r.map(t=>t.join(",")),"","--- รายละเอียดงาน ---","ชื่องาน,สถานะ,วันครบกำหนด",...e.map(t=>[`"${(t.title||"").replace(/"/g,'""')}"`,t.status||"-",t.dueDate||t.deadline||"-"].join(","))].join(`
`),a=new Blob(["\uFEFF"+l],{type:"text/csv;charset=utf-8;"}),c=new Date().toISOString().slice(0,10);i(a,`dashboard_${c}.csv`)}}export{y as exportDashboardData,g as exportMembers,j as exportReport};
