เอกสารฉบับนี้อธิบายความสามารถและวิธีใช้งานของเลขาบอท โดยยึดจากพฤติกรรมจริงของระบบในโค้ดปัจจุบัน เพื่อให้ผู้ใช้เข้าใจว่า “ใช้ทำอะไรได้บ้าง, มีอะไรบ้าง, ใช้อย่างไร” รวมถึงกรณีที่มีการแจ้งเตือนอัตโนมัติ

เอกสารแบ่งเป็น 2 ส่วนหลัก: (1) ใช้ “ในแชท LINE” และ (2) ใช้ “บนเว็บ (Dashboard)”

---

## เริ่มใช้งานแบบย่อ

1) เชิญบอทเข้ากลุ่ม LINE ของคุณ (บอทใช้งานได้เฉพาะ “ในกลุ่ม” ไม่รองรับแชท 1:1)

2) ในห้องแชท พิมพ์ (แท็กบอทหรือขึ้นต้นด้วย /):
```
@เลขา /setup
```
- บอทจะส่งลิงก์ Dashboard ที่ผูกกับกลุ่มให้
- พิมพ์ `@เลขา /whoami` แล้วกดลิงก์ "เปิดหน้าโปรไฟล์ (เว็บ)" เพื่อกรอก ชื่อจริง/อีเมล/เขตเวลา

3) (แนะนำ) ลิงก์อีเมลในหน้าโปรไฟล์ (เว็บ) เพื่อรับอีเมลแจ้งเตือนเมื่อผู้ดูแลเปิดใช้งาน

---

## ส่วนที่ 1) ใช้ “ในแชท LINE” (ละเอียด)

### วิธีเรียกใช้บอท
- แท็กชื่อบอทจริงๆ: `@เลขา …` แล้วพิมพ์คำสั่งต่อท้าย (แนะนำ)
- หรือพิมพ์คำสั่งที่ขึ้นต้นด้วย `/` เช่น `/help`, `/task …` (บอทจะตอบแม้ไม่แท็ก)

### แนวทางพิมพ์วันที่/เวลาและแท็ก
- รูปแบบวันที่/เวลา: `DD/MM HH:mm`, `DD/MM/YYYY HH:mm`, `YYYY-MM-DD HH:mm`, หรือเฉพาะเวลา `HH:mm`
- คำพิเศษ: `วันนี้`, `พรุ่งนี้`, `มะรืนนี้`, `สัปดาห์หน้า`, `เดือนหน้า` (เช่น `พรุ่งนี้ 9:00`)
- แท็กคนในงาน: แนะนำให้ “แท็กด้วยระบบ mention ของ LINE” ในข้อความ (การพิมพ์ `@ชื่อ` ด้วยตัวเองอาจไม่แม่นยำ)
- `@me` = ตัวคุณเอง (ใช้ในคำสั่งได้)
- ใช้ `#tag` เพื่อใส่แท็กงานในข้อความได้

### คำสั่งหลักในแชท (ตามที่โค้ดรองรับ)

- ดูวิธีใช้ทั้งหมด: `@เลขา /help`
- เปิดลิงก์ Dashboard กลุ่ม: `@เลขา /setup`
- ดูข้อมูลของฉัน: `@เลขา /whoami` (มีลิงก์ "เปิดหน้าโปรไฟล์ (เว็บ)" เพื่อกรอก ชื่อจริง/อีเมล/เขตเวลา)

งาน (Tasks)
- เพิ่มงานผ่านคำสั่ง:  
  `@เลขา /task add "ชื่องาน" @me due 25/12 14:00 #tag1 #tag2`
  - ระบบจะพาร์สชื่องาน (ในเครื่องหมายคำพูด), ผู้รับผิดชอบจาก mention, วัน/เวลาจาก `due …` หรือช่วงเวลา `เริ่ม … ถึง …`, และแท็ก `#…`
  - กรณีพิมพ์คำสั่งธรรมชาติว่า “เพิ่มงาน …” หรือ “add …” จะมี “การ์ดลิงก์” ให้กดไปกรอกงานในเว็บแทนการสร้างทันทีในแชท
- รายการงาน: `@เลขา /task list` หรือ `@เลขา /task list today|week|pending`  
  (รองรับไทย: `วันนี้|สัปดาห์|รอ`)
- งานของฉัน (ค้างอยู่): `@เลขา /task mine`
- ปิดงาน: `@เลขา /task done <รหัสงานหรือชื่องาน>`
- เลื่อนกำหนด: `@เลขา /task move <รหัสงาน> <วันเวลาใหม่>`

ส่งงาน/ตรวจงาน
- ส่งงาน (หลังแนบไฟล์ในแชท): `@เลขา /submit <รหัสงานหรือชื่องาน> [หมายเหตุ]`
  - ระบบจะค้นหา “ไฟล์ล่าสุดภายใน 24 ชั่วโมง” ที่คุณส่งในกลุ่ม มาแนบให้อัตโนมัติ (สูงสุด 5 ไฟล์) และจะแสดงการยืนยันแบบการ์ด (Flex) ให้กด “ยืนยันแนบ/ส่งโดยไม่แนบ/ยกเลิก”
- อนุมัติ: `@เลขา /approve <รหัสงานหรือชื่องาน>` → ปิดงานทันที
- ตีกลับ: `@เลขา /reject <รหัสงานหรือชื่องาน> [เหตุผล]`  
  (ระบบจะเลื่อนกำหนดส่งใหม่ “อัตโนมัติ +1 วันจากขณะตีกลับ” ไม่ต้องพิมพ์วันเอง)

ไฟล์ (Files)
- ดูไฟล์ล่าสุด: `@เลขา /files list` (แสดง 10 ไฟล์ล่าสุด)
- ค้นหาไฟล์: `@เลขา /files search <คำค้น>` (จะแสดงลิงก์ดาวน์โหลด/ดูต่อในเว็บ)

เคล็ดลัดและตัวอย่าง
- ตัวอย่างเพิ่มงาน:  
  `@เลขา /task add "ส่งรายงานยอดขาย Q3" @me due 25/12 14:00 #report #q3`
- ตัวอย่างเลื่อนงาน:  
  `@เลขา /task move abc12345 พรุ่งนี้ 9:00`
- อ้างอิงงานได้ด้วย “ชื่องาน” หรือ “รหัสงาน 8 ตัวแรก”

ข้อสังเกต
- งานที่ “บังคับแนบไฟล์” จะไม่สามารถปิดงานได้ หากยังไม่มีไฟล์แนบในงานนั้น
- บอทใช้งานเฉพาะในกลุ่มเท่านั้น หากพิมพ์ใน 1:1 จะได้รับข้อความแจ้งว่าไม่รองรับ

---

## เวิร์กโฟลว์ “ส่งงาน → ตรวจงาน” (ในแชท)

1) ผู้ทำงานแนบไฟล์ในห้องแชทตามปกติ (ภาพ/วิดีโอ/เสียง ฯลฯ)
2) ภายใน 24 ชม. พิมพ์: `@เลขา /submit <รหัสงานหรือชื่องาน> [หมายเหตุ]`  
   ระบบจะแสดงการ์ดยืนยันรายการไฟล์ที่จะถูกแนบ ให้กดยืนยัน
3) ระบบบันทึกเป็น “ส่งงานแล้ว” และแจ้ง “ผู้ตรวจ” ให้ตรวจภายใน 2 วัน
4) ผู้ตรวจตัดสินใจในแชท:
   - ผ่าน: `@เลขา /approve <รหัสหรือชื่อ>` → งานปิดสำเร็จและมีประกาศในกลุ่ม
   - ตีกลับ: `@เลขา /reject <รหัสหรือชื่อ> [เหตุผล]` → ระบบเลื่อนกำหนดส่งใหม่ +1 วันอัตโนมัติ

---

## การแจ้งเตือนและสรุปอัตโนมัติ (ตามระบบจริง)

- เตือนใกล้ครบกำหนด: เริ่มต้นที่ “1 วันก่อน” (รองรับช่วงอื่น เช่น 7 วัน/3 ชั่วโมง เมื่อกำหนดในงาน)
- เตือนซ้ำทุกเช้า 08:00 น. สำหรับงานที่ยังไม่เสร็จ
- งานเกินกำหนด: แจ้งเตือนพร้อมจำนวนชั่วโมงที่เกิน
- สรุปงานค้างประจำวัน เวลา 08:00 น. ส่งเข้าในกลุ่ม
- รายงานประจำสัปดาห์: ทุกวันศุกร์ 13:00 น. ส่งสถิติและอันดับ (Leaderboard) ในกลุ่ม
- รายงานผู้จัดการรายวัน (ส่วนตัว): หากผู้ดูแลตั้งผู้รับไว้ ระบบจะส่งสรุป “ยังไม่ส่ง/ล่าช้า/รอตรวจ” ให้
- อีเมล: หากผู้ดูแลเปิดใช้งานอีเมล และผู้ใช้ลิงก์อีเมลไว้ จะได้รับอีเมลเตือนเพิ่มเติม

---

## ส่วนที่ 2) ใช้ “บนเว็บ (Dashboard)”

การเข้าถึง
- พิมพ์ `@เลขา /setup` แล้วกดลิงก์ที่บอทส่ง (ระบบจะระบุ `groupId` ให้ถูกต้อง)

สิ่งที่ทำได้บน Dashboard
- ภาพรวม (Overview): ดูสถิติกลุ่มและงานล่าสุด
- ปฏิทิน (Calendar): ดูงานรายวัน/สัปดาห์/เดือน
- งาน (Tasks): ค้นหา/กรอง/แก้ไข/เลื่อนกำหนด/ปิดงาน, ส่งงาน (อัปโหลดไฟล์/แนบลิงก์)
- คลังไฟล์ (Files): ค้นหา/พรีวิว/ดาวน์โหลด (รองรับค้นตามชื่อ/แท็ก/ผู้อัปโหลด)
- อันดับ (Leaderboard/KPI): ดูคะแนนและอันดับแบบรายสัปดาห์/รายเดือน
- รายงาน (Reports): สรุปตามช่วงเวลา ดูรายบุคคล ส่งออกข้อมูล (JSON/CSV)
- ตั้งค่าโปรไฟล์: ชื่อจริง/อีเมล/เขตเวลา (เปิดจากลิงก์ในคำสั่ง `@เลขา /whoami`)

ความสามารถเพิ่มเติม (ขึ้นกับการตั้งค่าผู้ดูแล)
- งานประจำ (Recurring): ตั้งงานประจำแบบรายสัปดาห์/รายเดือนให้ระบบสร้างงานให้อัตโนมัติ
- ผู้รับรายงาน (Manager Recipients): ตั้งบัญชีที่จะรับสรุปส่วนตัวทุกเช้า
- ซิงก์ปฏิทิน Google: เมื่อเชื่อม Google Calendar ของกลุ่มไว้ งานใหม่/อัปเดตจะถูกซิงก์ไปเป็นอีเวนต์

ข้อกำหนดไฟล์บนเว็บ
- อัปโหลดได้โดยทั่วไปไม่เกิน ~25MB/ไฟล์ (ขึ้นกับการตั้งค่าเซิร์ฟเวอร์), ไฟล์จากแชทยังใช้ข้อจำกัดของ LINE

---

## คลังไฟล์ของกลุ่ม (สรุปรวม)

- ทุกไฟล์ที่ส่งในแชทและบันทึกสำเร็จจะเข้า “คลังไฟล์” อัตโนมัติ
- ดู/ค้น/พรีวิว/ดาวน์โหลดจาก Dashboard ได้สะดวก
- ค้นหาในแชทได้ด้วย: `@เลขา /files search <คำค้น>`


---

## สรุปคำสั่งสั้นๆ (ตามที่รองรับจริง)
```
/help                       ดูวิธีใช้ทั้งหมด
/setup                      เปิดลิงก์ Dashboard กลุ่ม
/whoami                     ดูข้อมูลของฉัน

/task add "ชื่อ" @me due 25/12 14:00   เพิ่มงาน
/task list [today|week|pending]         รายการงาน (ไทย: วันนี้|สัปดาห์|รอ)
/task mine                               งานของฉัน (ค้างอยู่)
/task done <รหัสหรือชื่อ>               ปิดงาน
/task move <รหัส> <วันเวลาใหม่>         เลื่อนกำหนด

/submit <รหัสหรือชื่อ> [หมายเหตุ]      ส่งงาน (หลังแนบไฟล์ในแชท; เลือกยืนยันไฟล์ได้)
/approve <รหัสหรือชื่อ>                 อนุมัติและปิดงาน
/reject <รหัสหรือชื่อ> [เหตุผล]        ตีกลับงาน (ระบบเลื่อนกำหนด +1 วันอัตโนมัติ)

/files list                              ดูไฟล์ล่าสุด
/files search <คำค้น>                    ค้นหาไฟล์
```

ต้องการความช่วยเหลือเพิ่มเติม พิมพ์ `@เลขา /help` ได้ทันที

