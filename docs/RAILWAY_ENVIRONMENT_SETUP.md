# üöÄ Railway Environment Variables Setup

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables ‡πÉ‡∏ô Railway Production

## ‚ö° **Quick Setup Guide**

### 1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Railway Dashboard
1. ‡πÄ‡∏Ç‡πâ‡∏≤ [Railway Dashboard](https://railway.app/)
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Project: `lekabot-production`
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Variables** tab

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables

**üö® ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ:**
```bash
LINE_CHANNEL_ACCESS_TOKEN=your_messaging_api_token
LINE_CHANNEL_SECRET=your_messaging_api_secret  
GOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your_google_client_secret
SMTP_USER=your-email@gmail.com
SMTP_PASS=your_gmail_app_password
```

**‚öôÔ∏è ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏±‡πâ‡∏á:**
```bash
BASE_URL=https://lekabot-production.up.railway.app
NODE_ENV=production
GOOGLE_REDIRECT_URI=https://lekabot-production.up.railway.app/auth/google/callback
DEFAULT_TIMEZONE=Asia/Bangkok
JWT_SECRET=your-super-secret-key-here
```

**üóÑÔ∏è Database (Railway ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥):**
```bash
DATABASE_URL=postgresql://postgres:password@host:port/railway
```

### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Webhook URL ‡πÉ‡∏ô LINE Developers Console

**Webhook URL:**
```
https://lekabot-production.up.railway.app/webhook
```

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [LINE Developers Console](https://developers.line.biz/)
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Channel ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì  
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Messaging API** tab
4. ‡πÉ‡∏™‡πà Webhook URL ‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô
5. ‡πÄ‡∏õ‡∏¥‡∏î "Use webhook" 
6. ‡πÄ‡∏õ‡∏¥‡∏î "Allow bot to join group chats"

### 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google OAuth Redirect URI  

**Authorized redirect URI:**
```
https://lekabot-production.up.railway.app/auth/google/callback
```

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Cloud Console](https://console.cloud.google.com/)
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Project ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **APIs & Services** ‚Üí **Credentials**
4. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å OAuth 2.0 Client ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
5. ‡πÄ‡∏û‡∏¥‡πà‡∏° URI ‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô‡πÉ‡∏ô "Authorized redirect URIs"

## üîç **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤**

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö:

### 1. Health Check
```
GET https://lekabot-production.up.railway.app/health
```

### 2. Dashboard
```
GET https://lekabot-production.up.railway.app/dashboard
```

### 3. Test ‡πÉ‡∏ô LINE Group
1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏≠‡∏ó‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏° LINE
2. ‡∏û‡∏¥‡∏°‡∏û‡πå `@‡πÄ‡∏•‡∏Ç‡∏≤ /help`  
3. ‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö

## üö® **Troubleshooting**

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢:

**1. Webhook Error (400/401)**
- ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `LINE_CHANNEL_SECRET` ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Webhook URL ‡πÉ‡∏ô LINE Console

**2. Database Error**  
- ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `DATABASE_URL` ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤
- ‚úÖ ‡∏£‡∏±‡∏ô `npm run db:test` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠

**3. Google Calendar ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**
- ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `GOOGLE_CLIENT_ID`, `GOOGLE_CLIENT_SECRET`
- ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Redirect URI ‡πÉ‡∏ô Google Console

**4. Email Notification ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**
- ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `SMTP_USER`, `SMTP_PASS`  
- ‚úÖ ‡πÉ‡∏ä‡πâ Gmail App Password (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥)

## üìã **Environment Variables Checklist**

### Required (5 ‡∏ï‡∏±‡∏ß):
- [ ] `LINE_CHANNEL_ACCESS_TOKEN`  
- [ ] `LINE_CHANNEL_SECRET`
- [ ] `GOOGLE_CLIENT_ID`
- [ ] `GOOGLE_CLIENT_SECRET`  
- [ ] `SMTP_USER`
- [ ] `SMTP_PASS`

### Recommended (5 ‡∏ï‡∏±‡∏ß):
- [ ] `BASE_URL`
- [ ] `NODE_ENV=production`
- [ ] `GOOGLE_REDIRECT_URI`
- [ ] `DEFAULT_TIMEZONE=Asia/Bangkok`
- [ ] `JWT_SECRET`

### Auto-Generated by Railway:
- [ ] `DATABASE_URL` (PostgreSQL)
- [ ] `PORT` (Auto-assigned)

## ‚úÖ **Success Indicators**

‡∏´‡∏≤‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô:

```bash
üöÄ ‡πÄ‡∏•‡∏Ç‡∏≤‡∏ö‡∏≠‡∏ó Started Successfully!
====================================
üì° Server running on port: 3000
üåê Base URL: https://lekabot-production.up.railway.app
üîß Environment: production
üì± LINE Bot ready to receive webhooks  
üìä Dashboard available at: https://lekabot-production.up.railway.app/dashboard
====================================
```

## üîó **Useful Links**

- [Railway Dashboard](https://railway.app/)
- [LINE Developers Console](https://developers.line.biz/) 
- [Google Cloud Console](https://console.cloud.google.com/)
- [Gmail App Passwords](https://myaccount.google.com/apppasswords)